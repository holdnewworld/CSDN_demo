!function(e){var t={};function n(o){if(t[o])return t[o].exports;var i=t[o]={i:o,l:!1,exports:{}};return e[o].call(i.exports,i,i.exports,n),i.l=!0,i.exports}n.m=e,n.c=t,n.d=function(e,t,o){n.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:o})},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=0)}([function(e,t,n){"use strict";n(1),n(2),n(3)},function(e,t){},function(e,t){},function(e,t,n){"use strict";var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}();THREE.StereoEffect=function(e){var t=new THREE.StereoCamera;t.aspect=.5,this.setEyeSeparation=function(e){t.eyeSep=e},this.setSize=function(t,n){e.setSize(t,n)},this.render=function(n,o){var i=e.getSize();i.width>=i.height?(t.aspect=.5,n.updateMatrixWorld(),null===o.parent&&o.updateMatrixWorld(),t.update(o),e.autoClear&&e.clear(),e.setScissorTest(!0),e.setScissor(0,0,i.width/2,i.height),e.setViewport(0,0,i.width/2,i.height),e.render(n,t.cameraL),e.setScissor(i.width/2,0,i.width/2,i.height),e.setViewport(i.width/2,0,i.width/2,i.height),e.render(n,t.cameraR)):(t.aspect=2,n.updateMatrixWorld(),null===o.parent&&o.updateMatrixWorld(),t.update(o),e.autoClear&&e.clear(),e.setScissorTest(!0),e.setScissor(0,0,i.width,i.height/2),e.setViewport(0,0,i.width,i.height/2),e.render(n,t.cameraL),e.setScissor(0,i.height/2,i.width,i.height/2),e.setViewport(0,i.height/2,i.width,i.height/2),e.render(n,t.cameraR)),e.setScissorTest(!1)}},THREE.DeviceOrientationControls=function(e){var t=this;this.object=e,this.object.rotation.reorder("YXZ"),this.enabled=!0,this.deviceOrientation={},this.screenOrientation=0,this.alpha=0,this.alphaOffsetAngle=0;var n=function(e){t.deviceOrientation=e},o=function(){t.screenOrientation=window.orientation||0},i=function(){var e=new THREE.Vector3(0,0,1),t=new THREE.Euler,n=new THREE.Quaternion,o=new THREE.Quaternion(-Math.sqrt(.5),0,0,Math.sqrt(.5));return function(i,a,r,c,s){t.set(r,a,-c,"YXZ"),i.setFromEuler(t),i.multiply(o),i.multiply(n.setFromAxisAngle(e,-s))}}();this.connect=function(){o(),window.addEventListener("orientationchange",o,!1),window.addEventListener("deviceorientation",n,!1),t.enabled=!0},this.disconnect=function(){window.removeEventListener("orientationchange",o,!1),window.removeEventListener("deviceorientation",n,!1),t.enabled=!1},this.update=function(){if(!1!==t.enabled){var e=t.deviceOrientation.alpha?THREE.Math.degToRad(t.deviceOrientation.alpha)+this.alphaOffsetAngle:0,n=t.deviceOrientation.beta?THREE.Math.degToRad(t.deviceOrientation.beta):0,o=t.deviceOrientation.gamma?THREE.Math.degToRad(t.deviceOrientation.gamma):0,a=t.screenOrientation?THREE.Math.degToRad(t.screenOrientation):0;i(t.object.quaternion,e,n,o,a),this.alpha=e}},this.updateAlphaOffsetAngle=function(e){this.alphaOffsetAngle=e,this.update()},this.dispose=function(){this.disconnect()},this.connect()};var i=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e);var t=this;t.settings={timeDelay:1e4,moveRate:.1,minFov:10,maxFov:120},t.constant={container:document.getElementById("container"),renderer:null,VRRenderer:null,camera:null,scene:null,light:null,skyBox:null,dop:new Dop,media:null,devices:null},t.state={position:{lon:0,lat:0,fov:60,phi:0,theta:0},mouse:{onMouseDownMouseX:0,onMouseDownMouseY:0,onMouseDownLon:0,onMouseDownLat:0,onTwoTouchX:0,onTwoTouchY:0,onMouseDownFov:0},autoMove:!0,timeout:null,canAutoMove:!1,renderer:null,gyro:!1},t._draw();var n=t.constant,o=n.dop,i=t.state,a=i.mouse,r=i.position,c=t.settings;n.media=n.dop.browserRedirect(),window.addEventListener("resize",function(){n.camera.aspect=window.innerWidth/window.innerHeight,n.camera.updateProjectionMatrix(),n.renderer.setSize(window.innerWidth,window.innerHeight)},!1);"pc"===n.media?n.container.addEventListener("mousedown",s,!1):n.container.addEventListener("touchstart",s,!1);function s(e){i.gyro||(e.preventDefault(),i.autoMove=!1,"pc"===n.media?(a.onMouseDownMouseX=e.clientX,a.onMouseDownMouseY=e.clientY):(a.onMouseDownMouseX=e.touches[0].clientX,a.onMouseDownMouseY=e.touches[0].clientY),"pc"!==n.media&&1!=e.touches.length||(a.onMouseDownLon=r.lon,a.onMouseDownLat=r.lat),"pc"===n.media?(document.addEventListener("mousemove",u,!1),document.addEventListener("mouseup",d,!1)):1==e.touches.length?(document.removeEventListener("touchmove",l,!1),document.addEventListener("touchmove",u,!1),document.addEventListener("touchend",d,!1)):2==e.touches.length&&(a.onTwoTouchX=e.touches[1].clientX,a.onTwoTouchY=e.touches[1].clientY,a.onMouseDownFov=r.fov,document.removeEventListener("touchmove",u,!1),document.addEventListener("touchmove",l,!1)))}function u(e){if(!1===i.autoMove){var t=void 0,o=void 0;"pc"===n.media?(t=e.clientX,o=e.clientY,r.lon=.1*(a.onMouseDownMouseX-t)*n.camera.fov/100+a.onMouseDownLon,r.lat=.1*(o-a.onMouseDownMouseY)*n.camera.fov/100+a.onMouseDownLat):(t=e.targetTouches[0].clientX,o=e.targetTouches[0].clientY,r.lon=.1*(a.onMouseDownMouseX-t)*n.camera.fov/50+a.onMouseDownLon,r.lat=.1*(o-a.onMouseDownMouseY)*n.camera.fov/50+a.onMouseDownLat)}}function l(e){if(1!=e.touches.length){var n=o.getRange(a.onMouseDownMouseX,a.onMouseDownMouseY,a.onTwoTouchX,a.onTwoTouchY),i=o.getRange(e.touches[0].clientX,e.touches[0].clientY,e.touches[1].clientX,e.touches[1].clientY);t.setSceneFov((n-i)/5+a.onMouseDownFov)}}function d(e){clearTimeout(i.timeout),document.removeEventListener("mousemove",u,!1),document.removeEventListener("mouseup",d,!1),document.removeEventListener("touchmove",u,!1),document.removeEventListener("touchmove",l,!1),document.removeEventListener("touchend",d,!1),i.timeout=setTimeout(function(){i.autoMove=!0},c.timeDelay)}o.wheel(n.container,function(){var e=n.camera.fov+3;n.camera.fov=THREE.Math.clamp(e,10,120),n.camera.updateProjectionMatrix()},function(){var e=n.camera.fov-3;n.camera.fov=THREE.Math.clamp(e,10,120),n.camera.updateProjectionMatrix()})}return o(e,[{key:"_initRender",value:function(){var e=this.constant,t=this.state;e.renderer=new THREE.WebGLRenderer,e.renderer.setPixelRatio(window.devicePixelRatio),e.renderer.setSize(e.container.clientWidth,e.container.clientHeight),e.renderer.setClearColor(16777215,1),e.container.appendChild(e.renderer.domElement),e.VRRenderer=new THREE.StereoEffect(e.renderer),t.renderer=e.renderer}},{key:"_initCamera",value:function(){var e=this.constant,t=this.state.position;e.camera=new THREE.PerspectiveCamera(t.fov,e.container.clientWidth/e.container.clientHeight,1,1e3),e.camera.target=new THREE.Vector3(0,0,0),e.devices=new THREE.DeviceOrientationControls(e.camera)}},{key:"_initScene",value:function(){this.constant.scene=new THREE.Scene}},{key:"_initLight",value:function(){}},{key:"_initModel",value:function(e){var t=this.constant,n=void 0;n=e||new THREE.MeshBasicMaterial({color:0}),t.skyBox=new THREE.Mesh(new THREE.CubeGeometry(200,200,200),n),t.skyBox.applyMatrix((new THREE.Matrix4).makeScale(1,1,-1)),t.scene.add(t.skyBox)}},{key:"updateMaterial",value:function(e){var t=this.constant,n=[];if(e)n=e;else for(var o=["r","l","u","d","b","f"],i=0;i<o.length;i++)n[i]="images/100000_2/"+o[i]+".jpg";for(var a=new THREE.TextureLoader,r=[],c=0,s=n.length;c<s;c++)r.push(new THREE.MeshBasicMaterial({map:a.load(n[c])}));t.scene.remove(t.skyBox),this._initModel(r)}},{key:"animate",value:function(){var e=this;!function t(){requestAnimationFrame(t),e.update()}()}},{key:"_draw",value:function(){this._initRender(),this._initCamera(),this._initScene(),this._initLight(),this._initModel(),this.animate()}},{key:"update",value:function(){var e=this.state,t=e.position,n=this.settings,o=this.constant;e.gyro?o.devices.update():(!0===e.autoMove&&e.canAutoMove&&(t.lon+=n.moveRate,Math.abs(t.lat)>.1&&(t.lat=t.lat>0?t.lat-.1:t.lat+.1)),t.lat=THREE.Math.clamp(t.lat,-89.99,89.99),t.phi=THREE.Math.degToRad(90-t.lat),t.theta=THREE.Math.degToRad(t.lon),o.camera.target.x=100*Math.sin(t.phi)*Math.cos(t.theta),o.camera.target.y=100*Math.cos(t.phi),o.camera.target.z=100*Math.sin(t.phi)*Math.sin(t.theta),o.camera.lookAt(o.camera.target)),e.renderer.render(o.scene,o.camera)}},{key:"setAutoMove",value:function(e){this.state.canAutoMove=e,this.state.autoMove=!0}},{key:"setFullScreen",value:function(e){var t=document.body;e?t.requestFullscreen?t.requestFullscreen():t.mozRequestFullScreen?t.mozRequestFullScreen():t.webkitRequestFullScreen?t.webkitRequestFullScreen():t.msRequestFullscreen&&t.msRequestFullscreen():document.exitFullscreen?document.exitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.webkitCancelFullScreen?document.webkitCancelFullScreen():document.msExitFullscreen&&document.msExitFullscreen()}},{key:"setGyro",value:function(e){this.state.gyro=!!e}},{key:"setVR",value:function(e){var t=this.constant,n=this.state;t.VRRenderer=new THREE.StereoEffect(t.renderer),e?n.renderer=t.VRRenderer:(t.renderer.setSize(t.container.clientWidth,t.container.clientHeight),n.renderer=t.renderer)}},{key:"setSceneCenter",value:function(e,t,n){var o=this.state.position;o.lon=+e,o.lat=+t,n&&this.setSceneFov(n)}},{key:"setSceneFov",value:function(e){var t=this.constant,n=this.state.position,o=this.settings;e&&(n.fov=THREE.Math.clamp(e,o.minFov,o.maxFov)),t.camera.fov=n.fov,t.camera.updateProjectionMatrix()}},{key:"getSceneCenter",value:function(){var e=this.state.position;return{lon:e.lon,lat:e.lat,fov:e.fov}}}]),e}();window.pano=new i;for(var a=[],r=["r","l","u","d","b","f"],c=0;c<r.length;c++)a[c]="images/100000_2/"+r[c]+".jpg";pano.updateMaterial(a);var s=document.querySelectorAll("#btn button"),u=new Dop,l=!1;u.$(s[0]).on("tap",function(){l=!l,pano.setAutoMove(l)});var d=!1;u.$(s[1]).on("tap",function(){d=!d,pano.setFullScreen(d)});var h=!1;u.$(s[2]).on("tap",function(){h=!h,pano.setGyro(h)});var v=!1;u.$(s[3]).on("tap",function(){v=!v,pano.setVR(v)}),u.$(s[4]).on("tap",function(){pano.setSceneCenter(180,80,45)}),u.$(s[5]).on("tap",function(){for(var e=0;e<r.length;e++)a[e]="images/100000_0/"+r[e]+".jpg";pano.updateMaterial(a)})}]);
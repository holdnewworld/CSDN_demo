/*! nan出品，必出精品 */!function(e){var t={};function n(o){if(t[o])return t[o].exports;var r=t[o]={i:o,l:!1,exports:{}};return e[o].call(r.exports,r,r.exports,n),r.l=!0,r.exports}n.m=e,n.c=t,n.d=function(e,t,o){n.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:o})},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=1)}([function(e,t,n){"use strict";var o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};function r(){var e=this,t={tap:function(t,n){return this.each(this,function(o,r){"pc"===e.browserRedirect()?(new e.AddComputerFun).init({dom:r,fun:t,event:"tap",preventDefault:n}):(new e.AddTouchFun).init({dom:r,fun:t,event:"tap",preventDefault:n})})},swipe:function(t,n){return this.each(this,function(o,r){"pc"===e.browserRedirect()?(new e.AddComputerFun).init({dom:r,fun:t,event:"swipe",preventDefault:n}):(new e.AddTouchFun).init({dom:r,fun:t,event:"swipe",preventDefault:n})})},on:function(t,n,o,r){return this.each(this,function(a,i){"function"==typeof o?"pc"===e.browserRedirect()?(new e.AddComputerFun).init({dom:i,fun:n,event:t,fun2:o,preventDefault:r}):(new e.AddTouchFun).init({dom:i,fun:n,event:t,fun2:o,preventDefault:r}):"pc"===e.browserRedirect()?(new e.AddComputerFun).init({dom:i,fun:n,event:t,preventDefault:o}):(new e.AddTouchFun).init({dom:i,fun:n,event:t,preventDefault:o})})},all:function(t,n,o,r){return this.each(this,function(a,i){"function"==typeof o?((new e.AddComputerFun).init({dom:i,fun:n,event:t,fun2:o,preventDefault:r}),(new e.AddTouchFun).init({dom:i,fun:n,event:t,fun2:o,preventDefault:r})):((new e.AddComputerFun).init({dom:i,fun:n,event:t,preventDefault:o}),(new e.AddTouchFun).init({dom:i,fun:n,event:t,preventDefault:o}))})},remove:function(t,n,o){return this.each(this,function(r,a){e.removeFun(a,t,n,o)})}};this.extendJQ=function(){var e=function(){},t=[],n=t.slice,r=t.concat,a=t.push,i=t.indexOf,s={},c=s.toString,u=s.hasOwnProperty,l="".trim;function d(t){var n=t.length,o=e.type(t);return"function"!==o&&!e.isWindow(t)&&(!(1!==t.nodeType||!n)||("array"===o||0===n||"number"==typeof n&&n>0&&n-1 in t))}e.fn=e.prototype={},e.extend=e.fn.extend=function(){var t,n,r,a,i,s,c=arguments[0]||{},u=1,l=arguments.length,d=!1;for("boolean"==typeof c&&(d=c,c=arguments[u]||{},u++),"object"===(void 0===c?"undefined":o(c))||e.isFunction(c)||(c={}),u===l&&(c=this,u--);u<l;u++)if(null!=(t=arguments[u]))for(n in t)r=c[n],c!==(a=t[n])&&(d&&a&&(e.isPlainObject(a)||(i=e.isArray(a)))?(i?(i=!1,s=r&&e.isArray(r)?r:[]):s=r&&e.isPlainObject(r)?r:{},c[n]=e.extend(d,s,a)):void 0!==a&&(c[n]=a));return c};var p={isReady:!0,error:function(e){throw new Error(e)},noop:function(){},isFunction:function(e){return"function"==typeof e},isArray:Array.isArray,isWindow:function(e){return null!=e&&e===e.window},isNumeric:function(e){return e-parseFloat(e)>=0},isPlainObject:function(t){if("object"!==e.type(t)||t.nodeType||e.isWindow(t))return!1;try{if(t.constructor&&!u.call(t.constructor.prototype,"isPrototypeOf"))return!1}catch(e){return!1}return!0},isEmptyObject:function(e){var t;for(t in e)return!1;return!0},type:function(e){return null==e?e+"":"object"===(void 0===e?"undefined":o(e))||"function"==typeof e?s[c.call(e)]||"object":void 0===e?"undefined":o(e)},globalEval:function(t){var n,o=eval;(t=e.trim(t))&&(1===t.indexOf("use strict")?((n=document.createElement("script")).text=t,document.head.appendChild(n).parentNode.removeChild(n)):o(t))},nodeName:function(e,t){return e.nodeName&&e.nodeName.toLowerCase()===t.toLowerCase()},each:function(e,t,n){var o=0,r=e.length,a=d(e);if(n){if(a)for(;o<r&&!1!==t.apply(e[o],n);o++);else for(o in e)if(!1===t.apply(e[o],n))break}else if(a)for(;o<r&&!1!==t.call(e[o],o,e[o]);o++);else for(o in e)if(!1===t.call(e[o],o,e[o]))break;return e},trim:function(e){return null==e?"":l.call(e)},makeArray:function(t,n){var o=n||[];return null!=t&&(d(Object(t))?e.merge(o,"string"==typeof t?[t]:t):a.call(o,t)),o},inArray:function(e,t,n){return null==t?-1:i.call(t,e,n)},merge:function(e,t){for(var n=+t.length,o=0,r=e.length;o<n;o++)e[r++]=t[o];return e.length=r,e},grep:function(e,t,n){for(var o=[],r=0,a=e.length,i=!n;r<a;r++)!t(e[r],r)!==i&&o.push(e[r]);return o},map:function(e,t,n){var o,a=0,i=e.length,s=[];if(d(e))for(;a<i;a++)null!=(o=t(e[a],a,n))&&s.push(o);else for(a in e)null!=(o=t(e[a],a,n))&&s.push(o);return r.apply([],s)},guid:1,proxy:function(t,o){var r,a,i;if("string"==typeof o&&(r=t[o],o=t,t=r),e.isFunction(t))return a=n.call(arguments,2),i=function(){return t.apply(o||this,a.concat(n.call(arguments)))},i.guid=t.guid=t.guid||e.guid++,i},now:Date.now};for(var h in e.extend(p),e)this[h]=e[h];return e},this.jquery=this.extendJQ(),this.AddTouchFun=function(){var t=this;t.settings={tapDurationThreshold:250,scrollSupressionThreshold:20,swipeDurationThreshold:750,horizontalDistanceThreshold:40,verticalDistanceThreshold:75,tapHoldDurationThreshold:750,doubleTapInterval:250},t.init=function(e){t.date={},t.arr=["swipe","swipeLeft","swipeRight","swipeUp","swipeDown","doubleTap","tap","singleTap","longTap","down","move","up"],t.touch={},t.dom=e.dom,t.callback=e.fun;for(var n=e.event.split(","),o=0;o<n.length;o++)-1!=t.arr.indexOf(n[o])&&t[n[o]](e.preventDefault)},t.tap=function(n){var o=void 0,r=function e(n){var r=n||window.event;t.tap.end=r.changedTouches,t.tap.endTime=Number(new Date),t.tap.endTime-t.tap.startTime<=t.settings.tapDurationThreshold&&1===t.tap.start.length&&1===t.tap.end.length&&t.getRange(t.tap.start[0].clientX,t.tap.start[0].clientY,t.tap.end[0].clientX,t.tap.end[0].clientY)<t.settings.scrollSupressionThreshold&&t.callback.call(t.dom,o),document.removeEventListener("touchend",e)},a=function(a){var i=a||window.event;n&&i.preventDefault(),t.tap.startTime=Number(new Date),t.tap.start=[];for(var s=i.targetTouches.length,c=0;c<s;c++){var u=e.jquery.extend(!0,{},i.targetTouches[c]);t.tap.start.push(u)}o=i,document.addEventListener("touchend",r)};t.dom.addEventListener("touchstart",a),t.dom.touchTap=a},t.singleTap=function(n){var o=void 0;t.singleTap.timeOut=null,t.singleTap.type=!1;var r=function e(n){var r=n||window.event;if(t.singleTap.end=r.changedTouches,t.singleTap.endTime=Number(new Date),t.singleTap.endTime-t.singleTap.startTime<=t.settings.tapDurationThreshold&&1===t.singleTap.start.length&&1===t.singleTap.end.length&&t.getRange(t.singleTap.start[0].clientX,t.singleTap.start[0].clientY,t.singleTap.end[0].clientX,t.singleTap.end[0].clientY)<t.settings.scrollSupressionThreshold){if(t.singleTap.type)return;t.singleTap.timeOut=setTimeout(function(){t.callback.call(t.dom,o)},t.settings.doubleTapInterval)}document.removeEventListener("touchend",e)},a=function(a){var i=a||window.event;n&&i.preventDefault(),t.singleTap.startTime=Number(new Date),t.singleTap.start=[],o=i,t.singleTap.startTime-t.singleTap.endTime<t.settings.doubleTapInterval?(clearTimeout(t.singleTap.timeOut),t.singleTap.type=!0):t.singleTap.type=!1;for(var s=i.targetTouches.length,c=0;c<s;c++){var u=e.jquery.extend(!0,{},i.targetTouches[c]);t.singleTap.start.push(u)}document.addEventListener("touchend",r)};t.dom.addEventListener("touchstart",a),t.dom.singleTouchTap=a},t.doubleTap=function(n){var o=void 0;t.doubleTap.prevTime=0;var r=function(e){var n=e||window.event;t.doubleTap.end=n.changedTouches,t.doubleTap.endTime=Number(new Date),t.doubleTap.endTime-t.doubleTap.startTime<=t.settings.tapDurationThreshold&&1===t.doubleTap.start.length&&1===t.doubleTap.end.length&&t.getRange(t.doubleTap.start[0].clientX,t.doubleTap.start[0].clientY,t.doubleTap.end[0].clientX,t.doubleTap.end[0].clientY)<t.settings.scrollSupressionThreshold?0!=t.doubleTap.prevTime&&t.doubleTap.startTime-t.doubleTap.prevTime<t.settings.doubleTapInterval?t.callback.call(t.dom,o):t.doubleTap.prevTime=t.doubleTap.endTime:t.doubleTap.prevTime=0},a=function(a){var i=a||window.event;n&&i.preventDefault(),t.doubleTap.startTime=Number(new Date),t.doubleTap.start=[];for(var s=i.targetTouches.length,c=0;c<s;c++){var u=e.jquery.extend(!0,{},i.targetTouches[c]);t.doubleTap.start.push(u)}o=i,document.addEventListener("touchend",r)};t.dom.addEventListener("touchstart",a),t.dom.doubleTouchTap=a},t.longTap=function(n){var o=void 0,r=function(r){var s=r||window.event;n&&s.preventDefault(),t.longTap.startTime=Number(new Date),t.longTap.start=e.jquery.extend(!0,{},s.targetTouches[0]),t.longTap.move=null,o=s,t.longTap.timeOut=setTimeout(function(){!t.longTap.move||t.getRange(t.longTap.start.clientX,t.longTap.start.clientY,t.longTap.move.clientX,t.longTap.move.clientY)<t.settings.scrollSupressionThreshold?(i(),t.callback.call(t.dom,o)):i()},t.settings.tapHoldDurationThreshold),document.addEventListener("touchmove",a),document.addEventListener("touchend",i)},a=function(n){var o=n||window.event;t.longTap.move=e.jquery.extend(!0,{},o.targetTouches[0])},i=function e(){clearTimeout(t.longTap.timeOut),document.removeEventListener("touchmove",a),document.removeEventListener("touchend",e)};t.dom.addEventListener("touchstart",r),t.dom.longTouchTap=r},t.swipe=function(n){var o=void 0,r=function e(n){var r=n||window.event;t.touch.end=r.changedTouches,t.date.end=Number(new Date),t.date.end-t.date.start<=t.settings.swipeDurationThreshold&&1===t.touch.start.length&&1===t.touch.end.length&&t.getRange(t.touch.start[0].clientX,t.touch.start[0].clientY,t.touch.end[0].clientX,t.touch.end[0].clientY)>t.settings.horizontalDistanceThreshold&&t.callback.call(t.dom,o),document.removeEventListener("touchend",e)},a=function(a){var i=a||window.event;n&&i.preventDefault(),t.date.start=Number(new Date),t.touch.start=[];for(var s=i.targetTouches.length,c=0;c<s;c++){var u=e.jquery.extend(!0,{},i.targetTouches[c]);t.touch.start.push(u)}o=i,document.addEventListener("touchend",r)};t.dom.addEventListener("touchstart",a),t.dom.touchSwipe=a},t.swipeLeft=function(n){var o=void 0,r=function e(n){var r=n||window.event;t.touch.end=r.changedTouches,t.date.end=Number(new Date),t.date.end-t.date.start<=t.settings.swipeDurationThreshold&&1===t.touch.start.length&&1===t.touch.end.length&&t.getRange(t.touch.start[0].clientX,t.touch.start[0].clientY,t.touch.end[0].clientX,t.touch.end[0].clientY)>t.settings.verticalDistanceThreshold&&(t.getAngle(t.touch.start[0].clientX,t.touch.start[0].clientY,t.touch.end[0].clientX,t.touch.end[0].clientY)>=315||t.getAngle(t.touch.start[0].clientX,t.touch.start[0].clientY,t.touch.end[0].clientX,t.touch.end[0].clientY)<=45)&&t.callback.call(t.dom,o),document.removeEventListener("touchend",e)},a=function(a){var i=a||window.event;n&&i.preventDefault(),t.date.start=Number(new Date),t.touch.start=[];for(var s=i.targetTouches.length,c=0;c<s;c++){var u=e.jquery.extend(!0,{},i.targetTouches[c]);t.touch.start.push(u)}o=i,document.addEventListener("touchend",r)};t.dom.addEventListener("touchstart",a),t.dom.touchSwipeLeft=a},t.swipeRight=function(n){var o=void 0,r=function e(n){var r=n||window.event;t.touch.end=r.changedTouches,t.date.end=Number(new Date),t.date.end-t.date.start<=t.settings.swipeDurationThreshold&&1===t.touch.start.length&&1===t.touch.end.length&&t.getRange(t.touch.start[0].clientX,t.touch.start[0].clientY,t.touch.end[0].clientX,t.touch.end[0].clientY)>t.settings.verticalDistanceThreshold&&t.getAngle(t.touch.start[0].clientX,t.touch.start[0].clientY,t.touch.end[0].clientX,t.touch.end[0].clientY)>=135&&t.getAngle(t.touch.start[0].clientX,t.touch.start[0].clientY,t.touch.end[0].clientX,t.touch.end[0].clientY)<=225&&t.callback.call(t.dom,o),document.removeEventListener("touchend",e)},a=function(a){var i=a||window.event;n&&i.preventDefault(),t.date.start=Number(new Date),t.touch.start=[];for(var s=i.targetTouches.length,c=0;c<s;c++){var u=e.jquery.extend(!0,{},i.targetTouches[c]);t.touch.start.push(u)}o=i,document.addEventListener("touchend",r)};t.dom.addEventListener("touchstart",a),t.dom.touchSwipeRight=a},t.swipeUp=function(n){var o=void 0,r=function e(n){var r=n||window.event;t.touch.end=r.changedTouches,t.date.end=Number(new Date),t.date.end-t.date.start<=t.settings.swipeDurationThreshold&&1===t.touch.start.length&&1===t.touch.end.length&&t.getRange(t.touch.start[0].clientX,t.touch.start[0].clientY,t.touch.end[0].clientX,t.touch.end[0].clientY)>t.settings.horizontalDistanceThreshold&&t.getAngle(t.touch.start[0].clientX,t.touch.start[0].clientY,t.touch.end[0].clientX,t.touch.end[0].clientY)>45&&t.getAngle(t.touch.start[0].clientX,t.touch.start[0].clientY,t.touch.end[0].clientX,t.touch.end[0].clientY)<135&&t.callback.call(t.dom,o),document.removeEventListener("touchend",e)},a=function(a){var i=a||window.event;n&&i.preventDefault(),t.date.start=Number(new Date),t.touch.start=[];for(var s=i.targetTouches.length,c=0;c<s;c++){var u=e.jquery.extend(!0,{},i.targetTouches[c]);t.touch.start.push(u)}o=i,document.addEventListener("touchend",r)};t.dom.addEventListener("touchstart",a),t.dom.touchSwipeUp=a},t.swipeDown=function(n){var o=void 0,r=function e(n){var r=n||window.event;t.touch.end=r.changedTouches,t.date.end=Number(new Date),t.date.end-t.date.start<=t.settings.swipeDurationThreshold&&1===t.touch.start.length&&1===t.touch.end.length&&t.getRange(t.touch.start[0].clientX,t.touch.start[0].clientY,t.touch.end[0].clientX,t.touch.end[0].clientY)>t.settings.horizontalDistanceThreshold&&t.getAngle(t.touch.start[0].clientX,t.touch.start[0].clientY,t.touch.end[0].clientX,t.touch.end[0].clientY)>225&&t.getAngle(t.touch.start[0].clientX,t.touch.start[0].clientY,t.touch.end[0].clientX,t.touch.end[0].clientY)<315&&t.callback.call(t.dom,o),document.removeEventListener("touchend",e)},a=function(a){var i=a||window.event;n&&i.preventDefault(),t.date.start=Number(new Date),t.touch.start=[];for(var s=i.targetTouches.length,c=0;c<s;c++){var u=e.jquery.extend(!0,{},i.targetTouches[c]);t.touch.start.push(u)}o=i,document.addEventListener("touchend",r)};t.dom.addEventListener("touchstart",a),t.dom.touchSwipeDown=a},t.down=function(e){t.dom.addEventListener("touchstart",t.callback,e)},t.move=function(e){t.dom.addEventListener("touchmove",t.callback,e)},t.up=function(e){t.dom.addEventListener("touchend",t.callback,e)},t.getAngle=function(e,t,n,o){var r=n-e,a=o-t,i=r/Math.sqrt(Math.pow(r,2)+Math.pow(a,2)),s=Math.acos(i),c=180/(Math.PI/s);return a<0?c=-c:0==a&&r<0&&(c=180),c+180},t.getRange=function(e,t,n,o){return Math.sqrt(Math.pow(Math.abs(e-n),2)+Math.pow(Math.abs(t-o),2))}},this.AddComputerFun=function(){var t=this;t.settings={tapDurationThreshold:250,scrollSupressionThreshold:5,swipeDurationThreshold:750,horizontalDistanceThreshold:40,verticalDistanceThreshold:75,tapHoldDurationThreshold:750,doubleTapInterval:250},t.init=function(e){t.dom=e.dom,t.callback=e.fun,t.callback2=e.fun2,t.date={},t.arr=["swipe","swipeLeft","swipeRight","swipeUp","swipeDown","doubleTap","tap","singleTap","longTap","wheel","down","move","up"],t.touch={};for(var n=e.event.split(","),o=0;o<n.length;o++)-1!=t.arr.indexOf(n[o])&&t[n[o]](e.preventDefault)},t.tap=function(n){var o=void 0,r=function e(n){var r=n||window.event;t.touch.end=r,t.date.end=+new Date,t.date.end-t.date.start<=t.settings.tapDurationThreshold&&t.getRange(t.touch.start.clientX,t.touch.start.clientY,t.touch.end.clientX,t.touch.end.clientY)<t.settings.scrollSupressionThreshold&&0===r.button&&t.callback.call(t.dom,o),document.removeEventListener("mouseup",e)},a=function(a){var i=a||window.event;n&&i.preventDefault(),t.date.start=Number(new Date),t.touch.start=e.jquery.extend(!0,{},i),o=a,document.addEventListener("mouseup",r)};t.dom.addEventListener("mousedown",a),t.dom.mouseTap=a},t.singleTap=function(n){var o=void 0;t.singleTap.timeOut=null,t.singleTap.type=!1;var r=function e(n){var r=n||window.event;if(t.singleTap.end=r,t.singleTap.endTime=+new Date,t.singleTap.endTime-t.singleTap.startTime<=t.settings.tapDurationThreshold&&t.getRange(t.singleTap.start.clientX,t.singleTap.start.clientY,t.singleTap.end.clientX,t.singleTap.end.clientY)<t.settings.scrollSupressionThreshold){if(t.singleTap.type)return;t.singleTap.timeOut=setTimeout(function(){t.callback.call(t.dom,o)},t.settings.doubleTapInterval)}document.removeEventListener("mouseup",e)},a=function(a){var i=a||window.event;n&&i.preventDefault(),t.singleTap.startTime=+new Date,t.singleTap.start=e.jquery.extend(!0,{},i),o=i,t.singleTap.startTime-t.singleTap.endTime<t.settings.doubleTapInterval?(clearTimeout(t.singleTap.timeOut),t.singleTap.type=!0):t.singleTap.type=!1,document.addEventListener("mouseup",r)};t.dom.addEventListener("mousedown",a),t.dom.singleMouseTap=a},t.doubleTap=function(n){var o=void 0;t.doubleTap.prevTime=0;var r=function n(r){var a=r||window.event;t.doubleTap.end=e.jquery.extend(!0,{},a),t.doubleTap.endTime=+new Date,t.doubleTap.endTime-t.doubleTap.startTime<=t.settings.tapDurationThreshold&&t.getRange(t.doubleTap.start.clientX,t.doubleTap.start.clientY,t.doubleTap.end.clientX,t.doubleTap.end.clientY)<t.settings.scrollSupressionThreshold?0!=t.doubleTap.prevTime&&t.doubleTap.endTime-t.doubleTap.prevTime<t.settings.doubleTapInterval?t.callback.call(t.dom,o):t.doubleTap.prevTime=t.doubleTap.endTime:t.doubleTap.prevTime=0,document.removeEventListener("mouseup",n)},a=function(a){var i=a||window.event;n&&i.preventDefault(),t.doubleTap.startTime=+new Date,t.doubleTap.start=e.jquery.extend(!0,{},i),o=i,document.addEventListener("mouseup",r)};t.dom.addEventListener("mousedown",a),t.dom.doubleMouseTap=a},t.longTap=function(n){var o=void 0,r=function(r){var s=r||window.event;n&&s.preventDefault(),t.longTap.startTime=+new Date,t.longTap.start=e.jquery.extend(!0,{},s),t.longTap.move=null,o=s,t.longTap.timeOut=setTimeout(function(){!t.longTap.move||t.getRange(t.longTap.start.clientX,t.longTap.start.clientY,t.longTap.move.clientX,t.longTap.move.clientY)<t.settings.scrollSupressionThreshold?(i(),t.callback.call(t.dom,o)):i()},t.settings.tapHoldDurationThreshold),document.addEventListener("mousemove",a),document.addEventListener("mouseup",i)},a=function(n){var o=n||window.event;t.longTap.move=e.jquery.extend(!0,{},o)},i=function e(){clearTimeout(t.longTap.timeOut),document.removeEventListener("mousemove",a),document.removeEventListener("mouseup",e)};t.dom.addEventListener("mousedown",r),t.dom.longMouseTap=r},t.swipe=function(n){var o=void 0,r=function e(n){var r=n||window.event;t.swipe.end=r,t.date.end=+new Date,t.date.end-t.date.start<=t.settings.swipeDurationThreshold&&t.getRange(t.swipe.start.clientX,t.swipe.start.clientY,t.swipe.end.clientX,t.swipe.end.clientY)>t.settings.horizontalDistanceThreshold&&t.callback.call(t.dom,o),document.removeEventListener("mouseup",e)},a=function(a){var i=a||window.event;n&&i.preventDefault(),t.date.start=+new Date,t.swipe.start=e.jquery.extend(!0,{},i),o=i,document.addEventListener("mouseup",r)};t.dom.addEventListener("mousedown",a),t.dom.mouseSwipe=a},t.swipeLeft=function(n){var o=void 0,r=function e(n){var r=n||window.event;t.touch.end=r,t.date.end=Number(new Date),t.date.end-t.date.start<=t.settings.swipeDurationThreshold&&t.getRange(t.touch.start.clientX,t.touch.start.clientY,t.touch.end.clientX,t.touch.end.clientY)>t.settings.verticalDistanceThreshold&&(t.getAngle(t.touch.start.clientX,t.touch.start.clientY,t.touch.end.clientX,t.touch.end.clientY)>=135||t.getAngle(t.touch.start.clientX,t.touch.start.clientY,t.touch.end.clientX,t.touch.end.clientY)<=-135)&&t.callback.call(t.dom,o),document.removeEventListener("mouseup",e)},a=function(a){var i=a||window.event;n&&i.preventDefault(),t.date.start=+new Date,t.touch.start=e.jquery.extend(!0,{},i),o=i,document.addEventListener("mouseup",r)};t.dom.addEventListener("mousedown",a),t.dom.mouseSwipeLeft=a},t.swipeRight=function(n){var o=void 0,r=function e(n){var r=n||window.event;t.touch.end=r,t.date.end=+new Date,t.date.end-t.date.start<=t.settings.swipeDurationThreshold&&t.getRange(t.touch.start.clientX,t.touch.start.clientY,t.touch.end.clientX,t.touch.end.clientY)>t.settings.verticalDistanceThreshold&&t.getAngle(t.touch.start.clientX,t.touch.start.clientY,t.touch.end.clientX,t.touch.end.clientY)>=-45&&t.getAngle(t.touch.start.clientX,t.touch.start.clientY,t.touch.end.clientX,t.touch.end.clientY)<=45&&t.callback.call(t.dom,o),document.removeEventListener("mouseup",e)},a=function(a){var i=a||window.event;n&&i.preventDefault(),t.date.start=+new Date,t.touch.start=e.jquery.extend(!0,{},i),o=i,document.addEventListener("mouseup",r)};t.dom.addEventListener("mousedown",a),t.dom.mouseSwipeRight=a},t.swipeUp=function(n){var o=void 0,r=function e(n){var r=n||window.event;t.touch.end=r,t.date.end=+new Date,t.date.end-t.date.start<=t.settings.swipeDurationThreshold&&t.getRange(t.touch.start.clientX,t.touch.start.clientY,t.touch.end.clientX,t.touch.end.clientY)>t.settings.horizontalDistanceThreshold&&t.getAngle(t.touch.start.clientX,t.touch.start.clientY,t.touch.end.clientX,t.touch.end.clientY)>-135&&t.getAngle(t.touch.start.clientX,t.touch.start.clientY,t.touch.end.clientX,t.touch.end.clientY)<-45&&t.callback.call(t.dom,o),document.removeEventListener("mouseup",e)},a=function(a){var i=a||window.event;n&&i.preventDefault(),t.date.start=+new Date,t.touch.start=e.jquery.extend(!0,{},i),o=i,document.addEventListener("mouseup",r)};t.dom.addEventListener("mousedown",a),t.dom.mouseSwipeUp=a},t.swipeDown=function(n){var o=void 0,r=function e(n){var r=n||window.event;t.touch.end=r,t.date.end=+new Date,t.date.end-t.date.start<=t.settings.swipeDurationThreshold&&t.getRange(t.touch.start.clientX,t.touch.start.clientY,t.touch.end.clientX,t.touch.end.clientY)>t.settings.horizontalDistanceThreshold&&t.getAngle(t.touch.start.clientX,t.touch.start.clientY,t.touch.end.clientX,t.touch.end.clientY)>45&&t.getAngle(t.touch.start.clientX,t.touch.start.clientY,t.touch.end.clientX,t.touch.end.clientY)<135&&t.callback.call(t.dom,o),document.removeEventListener("mouseup",e)},a=function(a){var i=a||window.event;n&&i.preventDefault(),t.date.start=+new Date,t.touch.start=e.jquery.extend(!0,{},i),o=i,document.addEventListener("mouseup",r)};t.dom.addEventListener("mousedown",a),t.dom.mouseSwipeDown=a},t.wheel=function(n){var o=t.dom,r=t.callback,a=t.callback2;function i(t){var i=t||window.event;function s(t,n){t>=0?e.jquery.isFunction(r)&&r.call(o,n):t<0&&e.jquery.isFunction(a)&&a.call(o,n)}n&&i.preventDefault(),i.wheelDelta?s(-i.wheelDelta/120,i):i.detail&&(-3===i.detail?s(-1,i):3===i.detail?s(1,i):console.log("鼠标滚轮事件改了？",i.wheelDelta))}o.addEventListener("mousewheel",i,!1),o.addEventListener("DOMMouseScroll",i,!1),t.dom.mouseScroll=i},t.down=function(e){t.dom.addEventListener("mousedown",t.callback,e)},t.move=function(e){t.dom.addEventListener("mousemove",t.callback,e)},t.up=function(e){t.dom.addEventListener("mouseup",t.callback,e)},t.getAngle=function(e,t,n,o){var r=n-e,a=o-t,i=r/Math.sqrt(Math.pow(r,2)+Math.pow(a,2)),s=Math.acos(i),c=180/(Math.PI/s);return a<0?c=-c:0==a&&r<0&&(c=180),c},t.getRange=function(e,t,n,o){return Math.sqrt(Math.pow(Math.abs(e-n),2)+Math.pow(Math.abs(t-o),2))}},this.removeFun=function(t,n,o,r){if("pc"!==e.browserRedirect()){if(o&&"move"!=n&&"up"!=n&&"wheel"!=n)return void t.removeEventListener("touchstart",o,r);switch(n){case"tap":t.removeEventListener("touchstart",t.touchTap,r);break;case"singleTap":t.removeEventListener("touchstart",t.singleTouchTap,r);break;case"doubleTap":t.removeEventListener("touchstart",t.doubleTouchTap,r);break;case"longTap":t.removeEventListener("touchstart",t.longTouchTap,r);break;case"swipe":t.removeEventListener("touchstart",t.touchSwipe,r);break;case"swipeLeft":t.removeEventListener("touchstart",t.touchSwipeLeft,r);break;case"swipeRight":t.removeEventListener("touchstart",t.touchSwipeRight,r);break;case"swipeUp":t.removeEventListener("touchstart",t.touchSwipeUp,r);break;case"swipeDown":t.removeEventListener("touchstart",t.touchSwipeDown,r);break;case"down":t.removeEventListener("touchstart",o,r);break;case"move":t.removeEventListener("touchmove",o,r);break;case"up":t.removeEventListener("touchend",o,r);break;case"wheel":t.removeEventListener("mousewheel",t.mouseScroll,r),t.removeEventListener("DOMMouseScroll",t.mouseScroll,r);break;default:t.removeEventListener(n,o,r)}}else{if(o&&"move"!=n&&"up"!=n&&"wheel"!=n)return void t.removeEventListener("mousedown",o,r);switch(n){case"tap":t.removeEventListener("mousedown",t.mouseTap,r);break;case"singleTap":t.removeEventListener("mousedown",t.singleMouseTap,r);break;case"doubleTap":t.removeEventListener("mousedown",t.doubleMouseTap,r);break;case"longTap":t.removeEventListener("mousedown",t.longMouseTap,r);break;case"swipe":t.removeEventListener("mousedown",t.mouseSwipe,r);break;case"swipeLeft":t.removeEventListener("mousedown",t.mouseSwipeLeft,r);break;case"swipeRight":t.removeEventListener("mousedown",t.mouseSwipeRight,r);break;case"swipeUp":t.removeEventListener("mousedown",t.mouseSwipeUp,r);break;case"swipeDown":t.removeEventListener("mousedown",t.mouseSwipeDown,r);break;case"wheel":t.removeEventListener("mousewheel",t.mouseScroll,r),t.removeEventListener("DOMMouseScroll",t.mouseScroll,r);break;case"down":t.removeEventListener("mousedown",o,r);break;case"move":t.removeEventListener("mousemove",o,r);break;case"up":t.removeEventListener("mouseup",o,r);break;default:t.removeEventListener(n,o,r)}}},this.touch=this.$=function(n){var o={};return e.isDom(n)?[].push.call(o,n):e.jquery.isArray(n)?[].push.apply(o,n):n.length>0?[].push.apply(o,n):[].push.call(o,n),this.jquery.extend(!0,o,this.jquery,t),o}}r.prototype={constructor:r,browserRedirect:function(){var e=navigator.userAgent.toLowerCase(),t="ipad"==e.match(/ipad/i),n="iphone os"==e.match(/iphone os/i),o="midp"==e.match(/midp/i),r="rv:1.2.3.4"==e.match(/rv:1.2.3.4/i),a="ucweb"==e.match(/ucweb/i),i="android"==e.match(/android/i),s="windows ce"==e.match(/windows ce/i),c="windows mobile"==e.match(/windows mobile/i);return t||n||o||r||a||i||s||c?t?"pad":document.body.clientWidth>767&&document.body.clientHeight>767?"pad":(document.body.clientWidth<400||document.body.clientHeight,"phone"):"pc"},getQueryString:function(e){var t=new RegExp("(^|&)"+e+"=([^&]*)(&|$)"),n=window.location.search.substr(1).match(t);return null!=n?decodeURI(n[2]):null},cloneObj:function(e,t,n){var r=n||!1;if("object"==(void 0===t?"undefined":o(t)))if(r)for(var a in t)"object"!=o(t[a])||t[a]instanceof HTMLElement?e[a]=t[a]:(t[a]instanceof Array?e[a]=[]:e[a]={},this.cloneObj(e[a],t[a],!0));else for(var a in t)e[a]=t[a]},inDom:function(e,t){return!(!t||!t.parentNode)&&(t.parentNode===e||t.parentNode!==document.body&&this.inDom(e,t.parentNode))},positionInDom:function(e,t,n){var o=n.getBoundingClientRect();return e>=o.left&&e<=o.right&&t>=o.top&&t<=o.bottom},getPrefix:function(){var e=document.body,t=["webkit","Moz","o","ms"];for(var n in t){var o=t[n]+"Transition";if(void 0!==e.style[o])return"-"+t[n].toLowerCase()+"-"}return!1},isDom:function(e){return("object"===("undefined"==typeof HTMLElement?"undefined":o(HTMLElement))?function(e){return e instanceof HTMLElement}:function(e){return e&&"object"===(void 0===e?"undefined":o(e))&&1===e.nodeType&&"string"==typeof e.nodeName})(e)},wheel:function(e,t,n){var o=this,r=arguments.length;function a(a){var i=a||window.event;function s(a,i){a>=0?r>=2&&o.jquery.isFunction(t)&&t.call(e,i):a<0&&r>=3&&o.jquery.isFunction(n)&&n.call(e,i)}i.wheelDelta?s(-i.wheelDelta/120,i):i.detail&&(-3===i.detail?s(-1,i):3===i.detail?s(1,i):console.log("鼠标滚轮事件改了？",i.wheelDelta))}e.addEventListener("mousewheel",a,!1),e.addEventListener("DOMMouseScroll",a,!1),e.mouseScroll=a},addImageHover:function(e,t,n){var o=new Image,r=new Image;o.src=t,r.src=n,e.addEventListener("mouseenter",function(){e.src=r.src}),e.addEventListener("mouseleave",function(){e.src=o.src})},listenArray:function(e,t){var n=Array.prototype,o=Object.create(n),r=[];["push","pop","shift","unshift","splice","sort","reverse"].forEach(function(n){var a=o[n];r[n]=function(){return t.call(e),a.apply(this,arguments)}}),e.__proto__=r},listenObj:function(e,t,n){var o=e[t];Object.defineProperty(e,t,{set:function(t){var r=o;o=t,n.call(e,t,r,this)},get:function(){return o}})},watch:function(e,t){var n=null;var o=function(e,t){if("object"===this.type(e)&&!this.isDom(e))if(this.isArray(e)){for(var n=0,r=e.length;n<r;n++)this.listenObj(e,n,t),"object"===this.type(e)&&o(e[n],t);this.listenArray(e,t)}else for(var a in e)"object"===this.type(e)&&o(e[a],t),this.listenObj(e,a,t)}.bind(this);o(e,function e(){var r=this;clearTimeout(n),n=setTimeout(function(){o(r,e),t.call(r)},10)})},getRange:function(e,t,n,o){return Math.sqrt(Math.pow(Math.abs(e-n),2)+Math.pow(Math.abs(t-o),2))},getTransformStyle:function(e){var t=e.style.cssText,n=t.match(/translate\((\S*)px,\s(\S*)px\)/),o=t.match(/scale\((\S*),\s(\S*)\)/),r=t.match(/rotate\((\S*)deg\)/),a=t.match(/skew\((\S*)deg,\s(\S*)deg\)/),i={};return n&&(i.translate={translateX:n[1],translateY:n[2]}),o&&(i.scale={scaleX:o[1],scaleY:o[2]}),r&&(i.rotate=r[1]),a&&(i.skew={skewX:a[1],skewY:a[2]}),i},setTransformStyle:function(e,t){switch(this.getPrefix()){case"-webkit-":e.style.webkitTransform=t;break;case"-Moz-":e.style.MozTransform=t;break;case"-o-":e.style.OTransform=t;break;case"-ms-":e.style.msTransform=t;break;default:e.style.transform=t}},getFinalStyle:function(e,t){return window.getComputedStyle(e,null)[t]},msg:function(e,t){var n=document.createElement("div"),o=this.getPrefix();switch(n.style.cssText="position:fixed; height:40px; line-height:40px; color:#fff; padding:0 20px; background:rgba(0,0,0,.5);border-radius:5px; "+o+"transition: all .5s ease-in-out; pointer-events:none; opacity:0; left:50%; margin:auto; z-index:9999999999999999;",t){case"top":n.style.top="200px";break;case"center":n.style.top=0,n.style.bottom=0;break;case"bottom":default:n.style.bottom="200px"}n.innerText=e,document.body.appendChild(n);var r=n.offsetWidth;n.style.marginLeft=-r/2+"px",setTimeout(function(){n.style.opacity=1}),setTimeout(function(){n.style.opacity=0,setTimeout(function(){n.parentNode.removeChild(n)},500)},3e3)},get:function(e,t,n){var o=+new Date,r=new XMLHttpRequest;-1!=e.indexOf("?")?r.open("GET",e+"&time="+o,!0):r.open("GET",e+"?time="+o,!0),r.onreadystatechange=function(){4==r.readyState&&200==r.status&&t(r.responseText)},r.ontimeout=n,r.onerror=n,r.upload.onprogress=function(e){},r.send()},post:function(e,t,n,o){var r=+new Date,a=new XMLHttpRequest;a.open("POST",e+"?time="+r,!0),a.setRequestHeader("Content-type","application/x-www-form-urlencoded"),a.onreadystatechange=function(){4==a.readyState&&200==a.status&&n(a.responseText)},a.ontimeout=o,a.onerror=o,a.upload.onprogress=function(e){},a.send(this.objToUrl(t).substr(1))},objToUrl:function(e,t,n){if(null==e)return"";var r="",a=void 0===e?"undefined":o(e);if("string"==a||"number"==a||"boolean"==a)r+="&"+t+"="+(null==n||n?encodeURIComponent(e):e);else for(var i in e){var s=null==t?i:t+(e instanceof Array?"["+i+"]":"."+i);r+=this.objToUrl(e[i],s,n)}return r},setCookie:function(e,t,n){var o=new Date;o.setTime(Number(o)+n),document.cookie=e+"="+escape(t)+(null==n?"":";expires="+o.toGMTString())},getCookie:function(e){if(document.cookie.length>0){var t=document.cookie.indexOf(e+"=");if(-1!=t){t=t+e.length+1;var n=document.cookie.indexOf(";",t);return-1==n&&(n=document.cookie.length),decodeURI(document.cookie.substring(t,n))}}return""}},e.exports=r},function(e,t,n){"use strict";n(2),n(7),n(8),n(9),window.THREE=THREE},function(e,t,n){var o=n(3);"string"==typeof o&&(o=[[e.i,o,""]]);var r={hmr:!0,transform:void 0};n(5)(o,r);o.locals&&(e.exports=o.locals)},function(e,t,n){(e.exports=n(4)(!1)).push([e.i,"* {\n  margin: 0;\n  padding: 0;\n}\nbody {\n  overflow: hidden;\n}\ncanvas {\n  display: block;\n}\n",""])},function(e,t){e.exports=function(e){var t=[];return t.toString=function(){return this.map(function(t){var n=function(e,t){var n=e[1]||"",o=e[3];if(!o)return n;if(t&&"function"==typeof btoa){var r=(i=o,"/*# sourceMappingURL=data:application/json;charset=utf-8;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(i))))+" */"),a=o.sources.map(function(e){return"/*# sourceURL="+o.sourceRoot+e+" */"});return[n].concat(a).concat([r]).join("\n")}var i;return[n].join("\n")}(t,e);return t[2]?"@media "+t[2]+"{"+n+"}":n}).join("")},t.i=function(e,n){"string"==typeof e&&(e=[[null,e,""]]);for(var o={},r=0;r<this.length;r++){var a=this[r][0];"number"==typeof a&&(o[a]=!0)}for(r=0;r<e.length;r++){var i=e[r];"number"==typeof i[0]&&o[i[0]]||(n&&!i[2]?i[2]=n:n&&(i[2]="("+i[2]+") and ("+n+")"),t.push(i))}},t}},function(e,t,n){var o,r,a={},i=(o=function(){return window&&document&&document.all&&!window.atob},function(){return void 0===r&&(r=o.apply(this,arguments)),r}),s=function(e){var t={};return function(e){if(void 0===t[e]){var n=function(e){return document.querySelector(e)}.call(this,e);if(n instanceof window.HTMLIFrameElement)try{n=n.contentDocument.head}catch(e){n=null}t[e]=n}return t[e]}}(),c=null,u=0,l=[],d=n(6);function p(e,t){for(var n=0;n<e.length;n++){var o=e[n],r=a[o.id];if(r){r.refs++;for(var i=0;i<r.parts.length;i++)r.parts[i](o.parts[i]);for(;i<o.parts.length;i++)r.parts.push(E(o.parts[i],t))}else{var s=[];for(i=0;i<o.parts.length;i++)s.push(E(o.parts[i],t));a[o.id]={id:o.id,refs:1,parts:s}}}}function h(e,t){for(var n=[],o={},r=0;r<e.length;r++){var a=e[r],i=t.base?a[0]+t.base:a[0],s={css:a[1],media:a[2],sourceMap:a[3]};o[i]?o[i].parts.push(s):n.push(o[i]={id:i,parts:[s]})}return n}function f(e,t){var n=s(e.insertInto);if(!n)throw new Error("Couldn't find a style target. This probably means that the value for the 'insertInto' parameter is invalid.");var o=l[l.length-1];if("top"===e.insertAt)o?o.nextSibling?n.insertBefore(t,o.nextSibling):n.appendChild(t):n.insertBefore(t,n.firstChild),l.push(t);else if("bottom"===e.insertAt)n.appendChild(t);else{if("object"!=typeof e.insertAt||!e.insertAt.before)throw new Error("[Style Loader]\n\n Invalid value for parameter 'insertAt' ('options.insertAt') found.\n Must be 'top', 'bottom', or Object.\n (https://github.com/webpack-contrib/style-loader#insertat)\n");var r=s(e.insertInto+" "+e.insertAt.before);n.insertBefore(t,r)}}function v(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e);var t=l.indexOf(e);t>=0&&l.splice(t,1)}function m(e){var t=document.createElement("style");return e.attrs.type="text/css",g(t,e.attrs),f(e,t),t}function g(e,t){Object.keys(t).forEach(function(n){e.setAttribute(n,t[n])})}function E(e,t){var n,o,r,a;if(t.transform&&e.css){if(!(a=t.transform(e.css)))return function(){};e.css=a}if(t.singleton){var i=u++;n=c||(c=m(t)),o=w.bind(null,n,i,!1),r=w.bind(null,n,i,!0)}else e.sourceMap&&"function"==typeof URL&&"function"==typeof URL.createObjectURL&&"function"==typeof URL.revokeObjectURL&&"function"==typeof Blob&&"function"==typeof btoa?(n=function(e){var t=document.createElement("link");return e.attrs.type="text/css",e.attrs.rel="stylesheet",g(t,e.attrs),f(e,t),t}(t),o=function(e,t,n){var o=n.css,r=n.sourceMap,a=void 0===t.convertToAbsoluteUrls&&r;(t.convertToAbsoluteUrls||a)&&(o=d(o));r&&(o+="\n/*# sourceMappingURL=data:application/json;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(r))))+" */");var i=new Blob([o],{type:"text/css"}),s=e.href;e.href=URL.createObjectURL(i),s&&URL.revokeObjectURL(s)}.bind(null,n,t),r=function(){v(n),n.href&&URL.revokeObjectURL(n.href)}):(n=m(t),o=function(e,t){var n=t.css,o=t.media;o&&e.setAttribute("media",o);if(e.styleSheet)e.styleSheet.cssText=n;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(n))}}.bind(null,n),r=function(){v(n)});return o(e),function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap)return;o(e=t)}else r()}}e.exports=function(e,t){if("undefined"!=typeof DEBUG&&DEBUG&&"object"!=typeof document)throw new Error("The style-loader cannot be used in a non-browser environment");(t=t||{}).attrs="object"==typeof t.attrs?t.attrs:{},t.singleton||"boolean"==typeof t.singleton||(t.singleton=i()),t.insertInto||(t.insertInto="head"),t.insertAt||(t.insertAt="bottom");var n=h(e,t);return p(n,t),function(e){for(var o=[],r=0;r<n.length;r++){var i=n[r];(s=a[i.id]).refs--,o.push(s)}e&&p(h(e,t),t);for(r=0;r<o.length;r++){var s;if(0===(s=o[r]).refs){for(var c=0;c<s.parts.length;c++)s.parts[c]();delete a[s.id]}}}};var b,T=(b=[],function(e,t){return b[e]=t,b.filter(Boolean).join("\n")});function w(e,t,n,o){var r=n?"":o.css;if(e.styleSheet)e.styleSheet.cssText=T(t,r);else{var a=document.createTextNode(r),i=e.childNodes;i[t]&&e.removeChild(i[t]),i.length?e.insertBefore(a,i[t]):e.appendChild(a)}}},function(e,t){e.exports=function(e){var t="undefined"!=typeof window&&window.location;if(!t)throw new Error("fixUrls requires window.location");if(!e||"string"!=typeof e)return e;var n=t.protocol+"//"+t.host,o=n+t.pathname.replace(/\/[^\/]*$/,"/");return e.replace(/url\s*\(((?:[^)(]|\((?:[^)(]+|\([^)(]*\))*\))*)\)/gi,function(e,t){var r,a=t.trim().replace(/^"(.*)"$/,function(e,t){return t}).replace(/^'(.*)'$/,function(e,t){return t});return/^(#|data:|http:\/\/|https:\/\/|file:\/\/\/)/i.test(a)?e:(r=0===a.indexOf("//")?a:0===a.indexOf("/")?n+a:o+a.replace(/^\.\//,""),"url("+JSON.stringify(r)+")")})}},function(e,t,n){"use strict";THREE.OrbitControls=function(e,t){var n,o,r,a,i;this.object=e,this.domElement=void 0!==t?t:document,this.enabled=!0,this.target=new THREE.Vector3,this.minDistance=0,this.maxDistance=1/0,this.minZoom=0,this.maxZoom=1/0,this.minPolarAngle=0,this.maxPolarAngle=Math.PI,this.minAzimuthAngle=-1/0,this.maxAzimuthAngle=1/0,this.enableDamping=!1,this.dampingFactor=.25,this.enableZoom=!0,this.zoomSpeed=1,this.enableRotate=!0,this.rotateSpeed=1,this.enablePan=!0,this.panSpeed=1,this.screenSpacePanning=!1,this.keyPanSpeed=7,this.autoRotate=!1,this.autoRotateSpeed=2,this.enableKeys=!0,this.keys={LEFT:37,UP:38,RIGHT:39,BOTTOM:40},this.mouseButtons={ORBIT:THREE.MOUSE.LEFT,ZOOM:THREE.MOUSE.MIDDLE,PAN:THREE.MOUSE.RIGHT},this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom,this.getPolarAngle=function(){return f.phi},this.getAzimuthalAngle=function(){return f.theta},this.saveState=function(){s.target0.copy(s.target),s.position0.copy(s.object.position),s.zoom0=s.object.zoom},this.reset=function(){s.target.copy(s.target0),s.object.position.copy(s.position0),s.object.zoom=s.zoom0,s.object.updateProjectionMatrix(),s.dispatchEvent(c),s.update(),p=d.NONE},this.update=(n=new THREE.Vector3,o=(new THREE.Quaternion).setFromUnitVectors(e.up,new THREE.Vector3(0,1,0)),r=o.clone().inverse(),a=new THREE.Vector3,i=new THREE.Quaternion,function(){var e=s.object.position;return n.copy(e).sub(s.target),n.applyQuaternion(o),f.setFromVector3(n),s.autoRotate&&p===d.NONE&&S(2*Math.PI/60/60*s.autoRotateSpeed),f.theta+=v.theta,f.phi+=v.phi,f.theta=Math.max(s.minAzimuthAngle,Math.min(s.maxAzimuthAngle,f.theta)),f.phi=Math.max(s.minPolarAngle,Math.min(s.maxPolarAngle,f.phi)),f.makeSafe(),f.radius*=m,f.radius=Math.max(s.minDistance,Math.min(s.maxDistance,f.radius)),s.target.add(g),n.setFromSpherical(f),n.applyQuaternion(r),e.copy(s.target).add(n),s.object.lookAt(s.target),!0===s.enableDamping?(v.theta*=1-s.dampingFactor,v.phi*=1-s.dampingFactor,g.multiplyScalar(1-s.dampingFactor)):(v.set(0,0,0),g.set(0,0,0)),m=1,!!(E||a.distanceToSquared(s.object.position)>h||8*(1-i.dot(s.object.quaternion))>h)&&(s.dispatchEvent(c),a.copy(s.object.position),i.copy(s.object.quaternion),E=!1,!0)}),this.dispose=function(){s.domElement.removeEventListener("contextmenu",q,!1),s.domElement.removeEventListener("mousedown",P,!1),s.domElement.removeEventListener("wheel",B,!1),s.domElement.removeEventListener("touchstart",U,!1),s.domElement.removeEventListener("touchend",V,!1),s.domElement.removeEventListener("touchmove",z,!1),document.removeEventListener("mousemove",F,!1),document.removeEventListener("mouseup",X,!1),window.removeEventListener("keydown",Y,!1)};var s=this,c={type:"change"},u={type:"start"},l={type:"end"},d={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_DOLLY_PAN:4},p=d.NONE,h=1e-6,f=new THREE.Spherical,v=new THREE.Spherical,m=1,g=new THREE.Vector3,E=!1,b=new THREE.Vector2,T=new THREE.Vector2,w=new THREE.Vector2,y=new THREE.Vector2,R=new THREE.Vector2,L=new THREE.Vector2,x=new THREE.Vector2,k=new THREE.Vector2,C=new THREE.Vector2;function D(){return Math.pow(.95,s.zoomSpeed)}function S(e){v.theta-=e}function H(e){v.phi-=e}var I,O=(I=new THREE.Vector3,function(e,t){I.setFromMatrixColumn(t,0),I.multiplyScalar(-e),g.add(I)}),A=function(){var e=new THREE.Vector3;return function(t,n){!0===s.screenSpacePanning?e.setFromMatrixColumn(n,1):(e.setFromMatrixColumn(n,0),e.crossVectors(s.object.up,e)),e.multiplyScalar(t),g.add(e)}}(),M=function(){var e=new THREE.Vector3;return function(t,n){var o=s.domElement===document?s.domElement.body:s.domElement;if(s.object.isPerspectiveCamera){var r=s.object.position;e.copy(r).sub(s.target);var a=e.length();a*=Math.tan(s.object.fov/2*Math.PI/180),O(2*t*a/o.clientHeight,s.object.matrix),A(2*n*a/o.clientHeight,s.object.matrix)}else s.object.isOrthographicCamera?(O(t*(s.object.right-s.object.left)/s.object.zoom/o.clientWidth,s.object.matrix),A(n*(s.object.top-s.object.bottom)/s.object.zoom/o.clientHeight,s.object.matrix)):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled."),s.enablePan=!1)}}();function N(e){s.object.isPerspectiveCamera?m/=e:s.object.isOrthographicCamera?(s.object.zoom=Math.max(s.minZoom,Math.min(s.maxZoom,s.object.zoom*e)),s.object.updateProjectionMatrix(),E=!0):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),s.enableZoom=!1)}function j(e){s.object.isPerspectiveCamera?m*=e:s.object.isOrthographicCamera?(s.object.zoom=Math.max(s.minZoom,Math.min(s.maxZoom,s.object.zoom/e)),s.object.updateProjectionMatrix(),E=!0):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),s.enableZoom=!1)}function P(e){if(!1!==s.enabled){switch(e.preventDefault(),e.button){case s.mouseButtons.ORBIT:if(!1===s.enableRotate)return;!function(e){b.set(e.clientX,e.clientY)}(e),p=d.ROTATE;break;case s.mouseButtons.ZOOM:if(!1===s.enableZoom)return;!function(e){x.set(e.clientX,e.clientY)}(e),p=d.DOLLY;break;case s.mouseButtons.PAN:if(!1===s.enablePan)return;!function(e){y.set(e.clientX,e.clientY)}(e),p=d.PAN}p!==d.NONE&&(document.addEventListener("mousemove",F,!1),document.addEventListener("mouseup",X,!1),s.dispatchEvent(u))}}function F(e){if(!1!==s.enabled)switch(e.preventDefault(),p){case d.ROTATE:if(!1===s.enableRotate)return;!function(e){T.set(e.clientX,e.clientY),w.subVectors(T,b).multiplyScalar(s.rotateSpeed);var t=s.domElement===document?s.domElement.body:s.domElement;S(2*Math.PI*w.x/t.clientHeight),H(2*Math.PI*w.y/t.clientHeight),b.copy(T),s.update()}(e);break;case d.DOLLY:if(!1===s.enableZoom)return;!function(e){k.set(e.clientX,e.clientY),C.subVectors(k,x),C.y>0?N(D()):C.y<0&&j(D()),x.copy(k),s.update()}(e);break;case d.PAN:if(!1===s.enablePan)return;!function(e){R.set(e.clientX,e.clientY),L.subVectors(R,y).multiplyScalar(s.panSpeed),M(L.x,L.y),y.copy(R),s.update()}(e)}}function X(e){!1!==s.enabled&&(document.removeEventListener("mousemove",F,!1),document.removeEventListener("mouseup",X,!1),s.dispatchEvent(l),p=d.NONE)}function B(e){!1===s.enabled||!1===s.enableZoom||p!==d.NONE&&p!==d.ROTATE||(e.preventDefault(),e.stopPropagation(),s.dispatchEvent(u),function(e){e.deltaY<0?j(D()):e.deltaY>0&&N(D()),s.update()}(e),s.dispatchEvent(l))}function Y(e){!1!==s.enabled&&!1!==s.enableKeys&&!1!==s.enablePan&&function(e){switch(e.keyCode){case s.keys.UP:M(0,s.keyPanSpeed),s.update();break;case s.keys.BOTTOM:M(0,-s.keyPanSpeed),s.update();break;case s.keys.LEFT:M(s.keyPanSpeed,0),s.update();break;case s.keys.RIGHT:M(-s.keyPanSpeed,0),s.update()}}(e)}function U(e){if(!1!==s.enabled){switch(e.preventDefault(),e.touches.length){case 1:if(!1===s.enableRotate)return;!function(e){b.set(e.touches[0].pageX,e.touches[0].pageY)}(e),p=d.TOUCH_ROTATE;break;case 2:if(!1===s.enableZoom&&!1===s.enablePan)return;!function(e){if(s.enableZoom){var t=e.touches[0].pageX-e.touches[1].pageX,n=e.touches[0].pageY-e.touches[1].pageY,o=Math.sqrt(t*t+n*n);x.set(0,o)}if(s.enablePan){var r=.5*(e.touches[0].pageX+e.touches[1].pageX),a=.5*(e.touches[0].pageY+e.touches[1].pageY);y.set(r,a)}}(e),p=d.TOUCH_DOLLY_PAN;break;default:p=d.NONE}p!==d.NONE&&s.dispatchEvent(u)}}function z(e){if(!1!==s.enabled)switch(e.preventDefault(),e.stopPropagation(),e.touches.length){case 1:if(!1===s.enableRotate)return;if(p!==d.TOUCH_ROTATE)return;!function(e){T.set(e.touches[0].pageX,e.touches[0].pageY),w.subVectors(T,b).multiplyScalar(s.rotateSpeed);var t=s.domElement===document?s.domElement.body:s.domElement;S(2*Math.PI*w.x/t.clientHeight),H(2*Math.PI*w.y/t.clientHeight),b.copy(T),s.update()}(e);break;case 2:if(!1===s.enableZoom&&!1===s.enablePan)return;if(p!==d.TOUCH_DOLLY_PAN)return;!function(e){if(s.enableZoom){var t=e.touches[0].pageX-e.touches[1].pageX,n=e.touches[0].pageY-e.touches[1].pageY,o=Math.sqrt(t*t+n*n);k.set(0,o),C.set(0,Math.pow(k.y/x.y,s.zoomSpeed)),N(C.y),x.copy(k)}if(s.enablePan){var r=.5*(e.touches[0].pageX+e.touches[1].pageX),a=.5*(e.touches[0].pageY+e.touches[1].pageY);R.set(r,a),L.subVectors(R,y).multiplyScalar(s.panSpeed),M(L.x,L.y),y.copy(R)}s.update()}(e);break;default:p=d.NONE}}function V(e){!1!==s.enabled&&(s.dispatchEvent(l),p=d.NONE)}function q(e){!1!==s.enabled&&e.preventDefault()}s.domElement.addEventListener("contextmenu",q,!1),s.domElement.addEventListener("mousedown",P,!1),s.domElement.addEventListener("wheel",B,!1),s.domElement.addEventListener("touchstart",U,!1),s.domElement.addEventListener("touchend",V,!1),s.domElement.addEventListener("touchmove",z,!1),window.addEventListener("keydown",Y,!1),this.update()},THREE.OrbitControls.prototype=Object.create(THREE.EventDispatcher.prototype),THREE.OrbitControls.prototype.constructor=THREE.OrbitControls,Object.defineProperties(THREE.OrbitControls.prototype,{center:{get:function(){return console.warn("THREE.OrbitControls: .center has been renamed to .target"),this.target}},noZoom:{get:function(){return console.warn("THREE.OrbitControls: .noZoom has been deprecated. Use .enableZoom instead."),!this.enableZoom},set:function(e){console.warn("THREE.OrbitControls: .noZoom has been deprecated. Use .enableZoom instead."),this.enableZoom=!e}},noRotate:{get:function(){return console.warn("THREE.OrbitControls: .noRotate has been deprecated. Use .enableRotate instead."),!this.enableRotate},set:function(e){console.warn("THREE.OrbitControls: .noRotate has been deprecated. Use .enableRotate instead."),this.enableRotate=!e}},noPan:{get:function(){return console.warn("THREE.OrbitControls: .noPan has been deprecated. Use .enablePan instead."),!this.enablePan},set:function(e){console.warn("THREE.OrbitControls: .noPan has been deprecated. Use .enablePan instead."),this.enablePan=!e}},noKeys:{get:function(){return console.warn("THREE.OrbitControls: .noKeys has been deprecated. Use .enableKeys instead."),!this.enableKeys},set:function(e){console.warn("THREE.OrbitControls: .noKeys has been deprecated. Use .enableKeys instead."),this.enableKeys=!e}},staticMoving:{get:function(){return console.warn("THREE.OrbitControls: .staticMoving has been deprecated. Use .enableDamping instead."),!this.enableDamping},set:function(e){console.warn("THREE.OrbitControls: .staticMoving has been deprecated. Use .enableDamping instead."),this.enableDamping=!e}},dynamicDampingFactor:{get:function(){return console.warn("THREE.OrbitControls: .dynamicDampingFactor has been renamed. Use .dampingFactor instead."),this.dampingFactor},set:function(e){console.warn("THREE.OrbitControls: .dynamicDampingFactor has been renamed. Use .dampingFactor instead."),this.dampingFactor=e}}})},function(e,t,n){"use strict";var o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};!function(){function e(e){var t,n=e.Content,o=e.RelativeFilename||e.Filename,r=o.slice(o.lastIndexOf(".")+1).toLowerCase();switch(r){case"bmp":t="image/bmp";break;case"jpg":case"jpeg":t="image/jpeg";break;case"png":t="image/png";break;case"tif":t="image/tiff";break;case"tga":if("function"!=typeof THREE.TGALoader)return void console.warn("FBXLoader: THREE.TGALoader is required to load TGA textures");null===THREE.Loader.Handlers.get(".tga")&&THREE.Loader.Handlers.add(/\.tga$/i,new THREE.TGALoader),t="image/tga";break;default:return void console.warn('FBXLoader: Image type "'+r+'" is not supported.')}if("string"==typeof n)return"data:"+t+";base64,"+n;var a=new Uint8Array(n);return window.URL.createObjectURL(new Blob([a],{type:t}))}function t(e,t,n,o){var r=function(e,t,n,o){var r,a,i=t.path,s=o.get(e.id).children;void 0!==s&&s.length>0&&void 0!==n[s[0].ID]&&(0!==(r=n[s[0].ID]).indexOf("blob:")&&0!==r.indexOf("data:")||t.setPath(void 0));a="tga"===e.FileName.slice(-3).toLowerCase()?THREE.Loader.Handlers.get(".tga").load(r):t.load(r);return t.setPath(i),a}(e,t,n,o);r.ID=e.id,r.name=e.attrName;var a=e.WrapModeU,i=e.WrapModeV,s=void 0!==a?a.value:0,c=void 0!==i?i.value:0;if(r.wrapS=0===s?THREE.RepeatWrapping:THREE.ClampToEdgeWrapping,r.wrapT=0===c?THREE.RepeatWrapping:THREE.ClampToEdgeWrapping,"Scaling"in e){var u=e.Scaling.value;r.repeat.x=u[0],r.repeat.y=u[1]}return r}function n(e,t,n,a){var i=t.id,s=t.attrName,c=t.ShadingModel;if("object"===(void 0===c?"undefined":o(c))&&(c=c.value),!a.has(i))return null;var u,l=function(e,t,n,o,a){var i={};t.BumpFactor&&(i.bumpScale=t.BumpFactor.value);t.Diffuse?i.color=(new THREE.Color).fromArray(t.Diffuse.value):t.DiffuseColor&&"Color"===t.DiffuseColor.type&&(i.color=(new THREE.Color).fromArray(t.DiffuseColor.value));t.DisplacementFactor&&(i.displacementScale=t.DisplacementFactor.value);t.Emissive?i.emissive=(new THREE.Color).fromArray(t.Emissive.value):t.EmissiveColor&&"Color"===t.EmissiveColor.type&&(i.emissive=(new THREE.Color).fromArray(t.EmissiveColor.value));t.EmissiveFactor&&(i.emissiveIntensity=parseFloat(t.EmissiveFactor.value));t.Opacity&&(i.opacity=parseFloat(t.Opacity.value));i.opacity<1&&(i.transparent=!0);t.ReflectionFactor&&(i.reflectivity=t.ReflectionFactor.value);t.Shininess&&(i.shininess=t.Shininess.value);t.Specular?i.specular=(new THREE.Color).fromArray(t.Specular.value):t.SpecularColor&&"Color"===t.SpecularColor.type&&(i.specular=(new THREE.Color).fromArray(t.SpecularColor.value));return a.get(o).children.forEach(function(t){var o=t.relationship;switch(o){case"Bump":i.bumpMap=n.get(t.ID);break;case"DiffuseColor":i.map=r(e,n,t.ID,a);break;case"DisplacementColor":i.displacementMap=r(e,n,t.ID,a);break;case"EmissiveColor":i.emissiveMap=r(e,n,t.ID,a);break;case"NormalMap":i.normalMap=r(e,n,t.ID,a);break;case"ReflectionColor":i.envMap=r(e,n,t.ID,a),i.envMap.mapping=THREE.EquirectangularReflectionMapping;break;case"SpecularColor":i.specularMap=r(e,n,t.ID,a);break;case"TransparentColor":i.alphaMap=r(e,n,t.ID,a),i.transparent=!0;break;case"AmbientColor":case"ShininessExponent":case"SpecularFactor":case"VectorDisplacementColor":default:console.warn("THREE.FBXLoader: %s map is not supported in three.js, skipping texture.",o)}}),i}(e,t,n,i,a);switch(c.toLowerCase()){case"phong":u=new THREE.MeshPhongMaterial;break;case"lambert":u=new THREE.MeshLambertMaterial;break;default:console.warn('THREE.FBXLoader: unknown material type "%s". Defaulting to MeshPhongMaterial.',c),u=new THREE.MeshPhongMaterial({color:3342591})}return u.setValues(l),u.name=s,u}function r(e,t,n,o){return"LayeredTexture"in e.Objects&&n in e.Objects.LayeredTexture&&(console.warn("THREE.FBXLoader: layered textures are not supported in three.js. Discarding all but first layer."),n=o.get(n).children[0].ID),t.get(n)}function a(e,t){var n=[];return e.children.forEach(function(e){var o=t[e.ID];if("Cluster"===o.attrType){var r={ID:e.ID,indices:[],weights:[],transform:(new THREE.Matrix4).fromArray(o.Transform.a),transformLink:(new THREE.Matrix4).fromArray(o.TransformLink.a),linkMode:o.Mode};"Indexes"in o&&(r.indices=o.Indexes.a,r.weights=o.Weights.a),n.push(r)}}),{rawBones:n,bones:[]}}function i(e,t,n,o){for(var r=[],a=0;a<e.children.length;a++){if(8===a){console.warn("FBXLoader: maximum of 8 morph targets supported. Ignoring additional targets.");break}var i=e.children[a],s=n[i.ID],c={name:s.attrName,initialWeight:s.DeformPercent,id:s.id,fullWeights:s.FullWeights.a};if("BlendShapeChannel"!==s.attrType)return;o.get(parseInt(i.ID)).children.forEach(function(e){"DeformPercent"===e.relationship?c.weightCurveID=e.ID:c.geoID=e.ID}),r.push(c)}return r}function s(e,t,n,o){switch(n.attrType){case"Mesh":return function(e,t,n,o){var r=o.skeletons,a=o.morphTargets,i=t.parents.map(function(t){return e.Objects.Model[t.ID]});if(0===i.length)return;var s=t.children.reduce(function(e,t){return void 0!==r[t.ID]&&(e=r[t.ID]),e},null),l=t.children.reduce(function(e,t){return void 0!==a[t.ID]&&(e=a[t.ID]),e},null),d=new THREE.Matrix4,p=i[0];if("GeometricRotation"in p){var h=p.GeometricRotation.value.map(THREE.Math.degToRad);h[3]="ZYX",d.makeRotationFromEuler((new THREE.Euler).fromArray(h))}"GeometricTranslation"in p&&d.setPosition((new THREE.Vector3).fromArray(p.GeometricTranslation.value));"GeometricScaling"in p&&d.scale((new THREE.Vector3).fromArray(p.GeometricScaling.value));return function(e,t,n,o,r){var a=new THREE.BufferGeometry;t.attrName&&(a.name=t.attrName);var i=function(e,t){var n={};n.vertexPositions=void 0!==e.Vertices?e.Vertices.a:[],n.vertexIndices=void 0!==e.PolygonVertexIndex?e.PolygonVertexIndex.a:[],e.LayerElementColor&&(n.color=function(e){var t=e.MappingInformationType,n=e.ReferenceInformationType,o=e.Colors.a,r=[];"IndexToDirect"===n&&(r=e.ColorIndex.a);return{dataSize:4,buffer:o,indices:r,mappingType:t,referenceType:n}}(e.LayerElementColor[0]));e.LayerElementMaterial&&(n.material=function(e){var t=e.MappingInformationType,n=e.ReferenceInformationType;if("NoMappingInformation"===t)return{dataSize:1,buffer:[0],indices:[0],mappingType:"AllSame",referenceType:n};for(var o=e.Materials.a,r=[],a=0;a<o.length;++a)r.push(a);return{dataSize:1,buffer:o,indices:r,mappingType:t,referenceType:n}}(e.LayerElementMaterial[0]));e.LayerElementNormal&&(n.normal=function(e){var t=e.MappingInformationType,n=e.ReferenceInformationType,o=e.Normals.a,r=[];"IndexToDirect"===n&&("NormalIndex"in e?r=e.NormalIndex.a:"NormalsIndex"in e&&(r=e.NormalsIndex.a));return{dataSize:3,buffer:o,indices:r,mappingType:t,referenceType:n}}(e.LayerElementNormal[0]));if(e.LayerElementUV){n.uv=[];for(var o=0;e.LayerElementUV[o];)n.uv.push(u(e.LayerElementUV[o])),o++}n.weightTable={},null!==t&&(n.skeleton=t,t.rawBones.forEach(function(e,t){e.indices.forEach(function(o,r){void 0===n.weightTable[o]&&(n.weightTable[o]=[]),n.weightTable[o].push({id:t,weight:e.weights[r]})})}));return n}(t,n),s=c(i),l=new THREE.Float32BufferAttribute(s.vertex,3);r.applyToBufferAttribute(l),a.addAttribute("position",l),s.colors.length>0&&a.addAttribute("color",new THREE.Float32BufferAttribute(s.colors,3));n&&(a.addAttribute("skinIndex",new THREE.Uint16BufferAttribute(s.weightsIndices,4)),a.addAttribute("skinWeight",new THREE.Float32BufferAttribute(s.vertexWeights,4)),a.FBX_Deformer=n);if(s.normal.length>0){var d=new THREE.Float32BufferAttribute(s.normal,3),p=(new THREE.Matrix3).getNormalMatrix(r);p.applyToBufferAttribute(d),a.addAttribute("normal",d)}if(s.uvs.forEach(function(e,t){var n="uv"+(t+1).toString();0===t&&(n="uv"),a.addAttribute(n,new THREE.Float32BufferAttribute(s.uvs[t],2))}),i.material&&"AllSame"!==i.material.mappingType){var h=s.materialIndex[0],f=0;if(s.materialIndex.forEach(function(e,t){e!==h&&(a.addGroup(f,t-f,h),h=e,f=t)}),a.groups.length>0){var v=a.groups[a.groups.length-1],m=v.start+v.count;m!==s.materialIndex.length&&a.addGroup(m,s.materialIndex.length-m,h)}0===a.groups.length&&a.addGroup(0,s.materialIndex.length,s.materialIndex[0])}return function(e,t,n,o,r){null!==o&&(t.morphAttributes.position=[],t.morphAttributes.normal=[],o.rawTargets.forEach(function(o){var a=e.Objects.Geometry[o.geoID];void 0!==a&&function(e,t,n,o){var r=new THREE.BufferGeometry;n.attrName&&(r.name=n.attrName);for(var a=void 0!==t.PolygonVertexIndex?t.PolygonVertexIndex.a:[],i=void 0!==t.Vertices?t.Vertices.a.slice():[],s=void 0!==n.Vertices?n.Vertices.a:[],u=void 0!==n.Indexes?n.Indexes.a:[],l=0;l<u.length;l++){var d=3*u[l];i[d]+=s[3*l],i[d+1]+=s[3*l+1],i[d+2]+=s[3*l+2]}var p=c({vertexIndices:a,vertexPositions:i}),h=new THREE.Float32BufferAttribute(p.vertex,3);h.name=n.attrName,o.applyToBufferAttribute(h),e.morphAttributes.position.push(h)}(t,n,a,r)}))}(e,a,t,o,r),a}(e,n,s,l,d)}(e,t,n,o);case"NurbsCurve":return function(e){if(void 0===THREE.NURBSCurve)return console.error("THREE.FBXLoader: The loader relies on THREE.NURBSCurve for any nurbs present in the model. Nurbs will show up as empty geometry."),new THREE.BufferGeometry;var t=parseInt(e.Order);if(isNaN(t))return console.error("THREE.FBXLoader: Invalid Order %s given for geometry ID: %s",e.Order,e.id),new THREE.BufferGeometry;for(var n,o,r=t-1,a=e.KnotVector.a,i=[],s=e.Points.a,c=0,u=s.length;c<u;c+=4)i.push((new THREE.Vector4).fromArray(s,c));if("Closed"===e.Form)i.push(i[0]);else if("Periodic"===e.Form){n=r,o=a.length-1-n;for(var c=0;c<r;++c)i.push(i[c])}var l=new THREE.NURBSCurve(r,a,i,n,o).getPoints(7*i.length),d=new Float32Array(3*l.length);l.forEach(function(e,t){e.toArray(d,3*t)});var p=new THREE.BufferGeometry;return p.addAttribute("position",new THREE.BufferAttribute(d,3)),p}(n)}}function c(e){var t={vertex:[],normal:[],colors:[],uvs:[],materialIndex:[],vertexWeights:[],weightsIndices:[]},n=0,o=0,r=!1,a=[],i=[],s=[],c=[],u=[],l=[];return e.vertexIndices.forEach(function(p,h){var f=!1;p<0&&(p^=-1,f=!0);var v=[],m=[];if(a.push(3*p,3*p+1,3*p+2),e.color){var g=d(h,n,p,e.color);s.push(g[0],g[1],g[2])}if(e.skeleton){if(void 0!==e.weightTable[p]&&e.weightTable[p].forEach(function(e){m.push(e.weight),v.push(e.id)}),m.length>4){r||(console.warn("THREE.FBXLoader: Vertex has more than 4 skinning weights assigned to vertex. Deleting additional weights."),r=!0);var E=[0,0,0,0],b=[0,0,0,0];m.forEach(function(e,t){var n=e,o=v[t];b.forEach(function(e,t,r){if(n>e){r[t]=n,n=e;var a=E[t];E[t]=o,o=a}})}),v=E,m=b}for(;m.length<4;)m.push(0),v.push(0);for(var T=0;T<4;++T)u.push(m[T]),l.push(v[T])}if(e.normal){g=d(h,n,p,e.normal);i.push(g[0],g[1],g[2])}if(e.material&&"AllSame"!==e.material.mappingType)var w=d(h,n,p,e.material)[0];e.uv&&e.uv.forEach(function(e,t){var o=d(h,n,p,e);void 0===c[t]&&(c[t]=[]),c[t].push(o[0]),c[t].push(o[1])}),o++,f&&(!function(e,t,n,o,r,a,i,s,c,u){for(var l=2;l<u;l++)e.vertex.push(t.vertexPositions[n[0]]),e.vertex.push(t.vertexPositions[n[1]]),e.vertex.push(t.vertexPositions[n[2]]),e.vertex.push(t.vertexPositions[n[3*(l-1)]]),e.vertex.push(t.vertexPositions[n[3*(l-1)+1]]),e.vertex.push(t.vertexPositions[n[3*(l-1)+2]]),e.vertex.push(t.vertexPositions[n[3*l]]),e.vertex.push(t.vertexPositions[n[3*l+1]]),e.vertex.push(t.vertexPositions[n[3*l+2]]),t.skeleton&&(e.vertexWeights.push(s[0]),e.vertexWeights.push(s[1]),e.vertexWeights.push(s[2]),e.vertexWeights.push(s[3]),e.vertexWeights.push(s[4*(l-1)]),e.vertexWeights.push(s[4*(l-1)+1]),e.vertexWeights.push(s[4*(l-1)+2]),e.vertexWeights.push(s[4*(l-1)+3]),e.vertexWeights.push(s[4*l]),e.vertexWeights.push(s[4*l+1]),e.vertexWeights.push(s[4*l+2]),e.vertexWeights.push(s[4*l+3]),e.weightsIndices.push(c[0]),e.weightsIndices.push(c[1]),e.weightsIndices.push(c[2]),e.weightsIndices.push(c[3]),e.weightsIndices.push(c[4*(l-1)]),e.weightsIndices.push(c[4*(l-1)+1]),e.weightsIndices.push(c[4*(l-1)+2]),e.weightsIndices.push(c[4*(l-1)+3]),e.weightsIndices.push(c[4*l]),e.weightsIndices.push(c[4*l+1]),e.weightsIndices.push(c[4*l+2]),e.weightsIndices.push(c[4*l+3])),t.color&&(e.colors.push(a[0]),e.colors.push(a[1]),e.colors.push(a[2]),e.colors.push(a[3*(l-1)]),e.colors.push(a[3*(l-1)+1]),e.colors.push(a[3*(l-1)+2]),e.colors.push(a[3*l]),e.colors.push(a[3*l+1]),e.colors.push(a[3*l+2])),t.material&&"AllSame"!==t.material.mappingType&&(e.materialIndex.push(o),e.materialIndex.push(o),e.materialIndex.push(o)),t.normal&&(e.normal.push(r[0]),e.normal.push(r[1]),e.normal.push(r[2]),e.normal.push(r[3*(l-1)]),e.normal.push(r[3*(l-1)+1]),e.normal.push(r[3*(l-1)+2]),e.normal.push(r[3*l]),e.normal.push(r[3*l+1]),e.normal.push(r[3*l+2])),t.uv&&t.uv.forEach(function(t,n){void 0===e.uvs[n]&&(e.uvs[n]=[]),e.uvs[n].push(i[n][0]),e.uvs[n].push(i[n][1]),e.uvs[n].push(i[n][2*(l-1)]),e.uvs[n].push(i[n][2*(l-1)+1]),e.uvs[n].push(i[n][2*l]),e.uvs[n].push(i[n][2*l+1])})}(t,e,a,w,i,s,c,u,l,o),n++,o=0,a=[],i=[],s=[],c=[],u=[],l=[])}),t}function u(e){var t=e.MappingInformationType,n=e.ReferenceInformationType,o=e.UV.a,r=[];return"IndexToDirect"===n&&(r=e.UVIndex.a),{dataSize:2,buffer:o,indices:r,mappingType:t,referenceType:n}}THREE.FBXLoader=function(e){this.manager=void 0!==e?e:THREE.DefaultLoadingManager},Object.assign(THREE.FBXLoader.prototype,{load:function(e,t,n,o){var r=this,a=THREE.LoaderUtils.extractUrlBase(e),i=new THREE.FileLoader(this.manager);i.setResponseType("arraybuffer"),i.load(e,function(n){try{var i=r.parse(n,a);t(i)}catch(t){window.setTimeout(function(){o&&o(t),r.manager.itemError(e)},0)}},n,o)},parse:function(o,r){var c,u,l;if(l="Kaydara FBX Binary  \0",(u=o).byteLength>=l.length&&l===H(u,0,l.length))c=(new L).parse(o);else{var d=H(o);if(!function(e){var t=["K","a","y","d","a","r","a","\\","F","B","X","\\","B","i","n","a","r","y","\\","\\"],n=0;function o(t){var o=e[t-1];return e=e.slice(n+t),n++,o}for(var r=0;r<t.length;++r){var a=o(1);if(a===t[r])return!1}return!0}(d))throw new Error("THREE.FBXLoader: Unknown format.");if(C(d)<7e3)throw new Error("THREE.FBXLoader: FBX version not supported, FileVersion: "+C(d));c=(new R).parse(d)}var b=function(e){var t=new Map;if("Connections"in e){var n=e.Connections.connections;n.forEach(function(e){var n=e[0],o=e[1],r=e[2];t.has(n)||t.set(n,{parents:[],children:[]});var a={ID:o,relationship:r};t.get(n).parents.push(a),t.has(o)||t.set(o,{parents:[],children:[]});var i={ID:n,relationship:r};t.get(o).children.push(i)})}return t}(c),T=function(t){var n={},o={};if("Video"in t.Objects){var r=t.Objects.Video;for(var a in r){var i=r[a],s=parseInt(a);if(n[s]=i.RelativeFilename||i.Filename,"Content"in i){var c=i.Content instanceof ArrayBuffer&&i.Content.byteLength>0,u="string"==typeof i.Content&&""!==i.Content;if(c||u){var l=e(r[a]);o[i.RelativeFilename||i.Filename]=l}}}}for(var s in n){var d=n[s];void 0!==o[d]?n[s]=o[d]:n[s]=n[s].split("\\").pop()}return n}(c),w=function(e,t,o){var r=new Map;if("Material"in e.Objects){var a=e.Objects.Material;for(var i in a){var s=n(e,a[i],t,o);null!==s&&r.set(parseInt(i),s)}}return r}(c,function(e,n,o,r){var a=new Map;if("Texture"in e.Objects){var i=e.Objects.Texture;for(var s in i){var c=t(i[s],n,o,r);a.set(parseInt(s),c)}}return a}(c,new THREE.TextureLoader(this.manager).setPath(r),T,b),b),y=function(e,t){var n={},o={};if("Deformer"in e.Objects){var r=e.Objects.Deformer;for(var s in r){var c=r[s],u=t.get(parseInt(s));if("Skin"===c.attrType){var l=a(u,r);l.ID=s,u.parents.length>1&&console.warn("THREE.FBXLoader: skeleton attached to more than one geometry is not supported."),l.geometryID=u.parents[0].ID,n[s]=l}else if("BlendShape"===c.attrType){var d={id:s};d.rawTargets=i(u,c,r,t),d.id=s,u.parents.length>1&&console.warn("THREE.FBXLoader: morph target attached to more than one geometry is not supported."),d.parentGeoID=u.parents[0].ID,o[s]=d}}}return{skeletons:n,morphTargets:o}}(c,b),x=function(e,t,n){var o=new Map;if("Geometry"in e.Objects){var r=e.Objects.Geometry;for(var a in r){var i=t.get(parseInt(a)),c=s(e,i,r[a],n);o.set(parseInt(a),c)}}return o}(c,b,y);return function(e,t,n,o,r){var a=new THREE.Group,i=function(e,t,n,o,r){var a=new Map,i=e.Objects.Model;for(var s in i){var c=parseInt(s),u=i[s],l=r.get(c),d=p(l,t,c,u.attrName);if(!d){switch(u.attrType){case"Camera":d=h(e,l);break;case"Light":d=f(e,l);break;case"Mesh":d=v(e,l,n,o);break;case"NurbsCurve":d=m(l,n);break;case"LimbNode":case"Null":default:d=new THREE.Group}d.name=THREE.PropertyBinding.sanitizeNodeName(u.attrName),d.ID=c}g(e,d,u),a.set(c,d)}return a}(e,n,o,r,t),s=e.Objects.Model;return i.forEach(function(n){var o=s[n.ID];!function(e,t,n,o,r){if("LookAtProperty"in n){var a=o.get(t.ID).children;a.forEach(function(n){if("LookAtProperty"===n.relationship){var o=e.Objects.Model[n.ID];if("Lcl_Translation"in o){var a=o.Lcl_Translation.value;void 0!==t.target?(t.target.position.fromArray(a),r.add(t.target)):t.lookAt((new THREE.Vector3).fromArray(a))}}})}}(e,n,o,t,a),t.get(n.ID).parents.forEach(function(e){var t=i.get(e.ID);void 0!==t&&t.add(n)}),null===n.parent&&a.add(n)}),function(e,t,n,o,r){var a=function(e){var t={};if("Pose"in e.Objects){var n=e.Objects.Pose;for(var o in n)if("BindPose"===n[o].attrType){var r=n[o].PoseNode;Array.isArray(r)?r.forEach(function(e){t[e.Node]=(new THREE.Matrix4).fromArray(e.Matrix.a)}):t[r.Node]=(new THREE.Matrix4).fromArray(r.Matrix.a)}}return t}(e);for(var i in t){var s=t[i],c=r.get(parseInt(s.ID)).parents;c.forEach(function(e){if(n.has(e.ID)){var t=e.ID,i=r.get(t);i.parents.forEach(function(e){if(o.has(e.ID)){var t=o.get(e.ID);t.bind(new THREE.Skeleton(s.bones),a[e.ID])}})}})}}(e,n,o,i,t),function(e,t,n){n.animations=[];var o=function(e,t){if(void 0!==e.Objects.AnimationCurve){var n=function(e){var t=e.Objects.AnimationCurveNode,n=new Map;for(var o in t){var r=t[o];if(null!==r.attrName.match(/S|R|T/)){var a={id:r.id,attr:r.attrName,curves:{}};n.set(a.id,a)}}return n}(e);!function(e,t,n){var o=e.Objects.AnimationCurve;for(var r in o){var a={id:o[r].id,times:o[r].KeyTime.a.map(D),values:o[r].KeyValueFloat.a},i=t.get(a.id);if(void 0!==i){var s=i.parents[0].ID,c=i.parents[0].relationship;c.match(/X/)?n.get(s).curves.x=a:c.match(/Y/)?n.get(s).curves.y=a:c.match(/Z/)&&(n.get(s).curves.z=a)}}}(e,t,n);var o=function(e,t,n){var o=e.Objects.AnimationLayer,r=new Map;for(var a in o){var i=[],s=t.get(parseInt(a));if(void 0!==s){var c=s.children;c.forEach(function(o,r){if(n.has(o.ID)){var a=n.get(o.ID);if(void 0!==a.curves.x||void 0!==a.curves.y||void 0!==a.curves.z){if(void 0===i[r]){var s;t.get(o.ID).parents.forEach(function(e){void 0!==e.relationship&&(s=e.ID)});var c=e.Objects.Model[s.toString()],u={modelName:THREE.PropertyBinding.sanitizeNodeName(c.attrName),initialPosition:[0,0,0],initialRotation:[0,0,0],initialScale:[1,1,1]};"Lcl_Translation"in c&&(u.initialPosition=c.Lcl_Translation.value),"Lcl_Rotation"in c&&(u.initialRotation=c.Lcl_Rotation.value),"Lcl_Scaling"in c&&(u.initialScale=c.Lcl_Scaling.value),"PreRotation"in c&&(u.preRotations=c.PreRotation.value),i[r]=u}i[r][a.attr]=a}}}),r.set(parseInt(a),i)}}return r}(e,t,n);return function(e,t,n){var o=e.Objects.AnimationStack,r={};for(var a in o){var i=t.get(parseInt(a)).children;i.length>1&&console.warn("THREE.FBXLoader: Encountered an animation stack with multiple layers, this is currently not supported. Ignoring subsequent layers.");var s=n.get(i[0].ID);r[a]={name:o[a].attrName,layer:s}}return r}(e,t,o)}}(e,t);if(void 0!==o)for(var r in o){var a=o[r],i=E(a);n.animations.push(i)}}(e,t,a),function(e,t){if("GlobalSettings"in e&&"AmbientColor"in e.GlobalSettings){var n=e.GlobalSettings.AmbientColor.value,o=n[0],r=n[1],a=n[2];if(0!==o||0!==r||0!==a){var i=new THREE.Color(o,r,a);t.add(new THREE.AmbientLight(i,1))}}}(e,a),a}(c,b,y.skeletons,x,w)}});var l=[];function d(e,t,n,o){var r;switch(o.mappingType){case"ByPolygonVertex":r=e;break;case"ByPolygon":r=t;break;case"ByVertice":r=n;break;case"AllSame":r=o.indices[0];break;default:console.warn("THREE.FBXLoader: unknown attribute mapping type "+o.mappingType)}"IndexToDirect"===o.referenceType&&(r=o.indices[r]);var a=r*o.dataSize,i=a+o.dataSize;return function(e,t,n,o){for(var r=n,a=0;r<o;r++,a++)e[a]=t[r];return e}(l,o.buffer,a,i)}function p(e,t,n,o){var r=null;return e.parents.forEach(function(e){for(var a in t){var i=t[a];i.rawBones.forEach(function(t,a){if(t.ID===e.ID){var s=r;(r=new THREE.Bone).matrixWorld.copy(t.transformLink),r.name=THREE.PropertyBinding.sanitizeNodeName(o),r.ID=n,i.bones[a]=r,null!==s&&r.add(s)}})}}),r}function h(e,t){var n,o;if(t.children.forEach(function(t){var n=e.Objects.NodeAttribute[t.ID];void 0!==n&&(o=n)}),void 0===o)n=new THREE.Object3D;else{var r=0;void 0!==o.CameraProjectionType&&1===o.CameraProjectionType.value&&(r=1);var a=1;void 0!==o.NearPlane&&(a=o.NearPlane.value/1e3);var i=1e3;void 0!==o.FarPlane&&(i=o.FarPlane.value/1e3);var s=window.innerWidth,c=window.innerHeight;void 0!==o.AspectWidth&&void 0!==o.AspectHeight&&(s=o.AspectWidth.value,c=o.AspectHeight.value);var u=s/c,l=45;void 0!==o.FieldOfView&&(l=o.FieldOfView.value);var d=o.FocalLength?o.FocalLength.value:null;switch(r){case 0:n=new THREE.PerspectiveCamera(l,u,a,i),null!==d&&n.setFocalLength(d);break;case 1:n=new THREE.OrthographicCamera(-s/2,s/2,c/2,-c/2,a,i);break;default:console.warn("THREE.FBXLoader: Unknown camera type "+r+"."),n=new THREE.Object3D}}return n}function f(e,t){var n,o;if(t.children.forEach(function(t){var n=e.Objects.NodeAttribute[t.ID];void 0!==n&&(o=n)}),void 0===o)n=new THREE.Object3D;else{var r;r=void 0===o.LightType?0:o.LightType.value;var a=16777215;void 0!==o.Color&&(a=(new THREE.Color).fromArray(o.Color.value));var i=void 0===o.Intensity?1:o.Intensity.value/100;void 0!==o.CastLightOnObject&&0===o.CastLightOnObject.value&&(i=0);var s=0;void 0!==o.FarAttenuationEnd&&(s=void 0!==o.EnableFarAttenuation&&0===o.EnableFarAttenuation.value?0:o.FarAttenuationEnd.value);switch(r){case 0:n=new THREE.PointLight(a,i,s,1);break;case 1:n=new THREE.DirectionalLight(a,i);break;case 2:var c=Math.PI/3;void 0!==o.InnerAngle&&(c=THREE.Math.degToRad(o.InnerAngle.value));var u=0;void 0!==o.OuterAngle&&(u=THREE.Math.degToRad(o.OuterAngle.value),u=Math.max(u,1)),n=new THREE.SpotLight(a,i,s,c,u,1);break;default:console.warn("THREE.FBXLoader: Unknown light type "+o.LightType.value+", defaulting to a THREE.PointLight."),n=new THREE.PointLight(a,i)}void 0!==o.CastShadows&&1===o.CastShadows.value&&(n.castShadow=!0)}return n}function v(e,t,n,o){var r,a=null,i=null,s=[];return t.children.forEach(function(e){n.has(e.ID)&&(a=n.get(e.ID)),o.has(e.ID)&&s.push(o.get(e.ID))}),s.length>1?i=s:s.length>0?i=s[0]:(i=new THREE.MeshPhongMaterial({color:13421772}),s.push(i)),"color"in a.attributes&&s.forEach(function(e){e.vertexColors=THREE.VertexColors}),a.FBX_Deformer?(s.forEach(function(e){e.skinning=!0}),r=new THREE.SkinnedMesh(a,i)):r=new THREE.Mesh(a,i),r}function m(e,t){var n=e.children.reduce(function(e,n){return t.has(n.ID)&&(e=t.get(n.ID)),e},null),o=new THREE.LineBasicMaterial({color:3342591,linewidth:1});return new THREE.Line(n,o)}function g(e,t,n){if("RotationOrder"in n){var o=parseInt(n.RotationOrder.value,10);o>0&&o<6?console.warn("THREE.FBXLoader: unsupported Euler Order: %s. Currently only XYZ order is supported. Animations and rotations may be incorrect.",["XYZ","XZY","YZX","ZXY","YXZ","ZYX","SphericXYZ"][o]):6===o&&console.warn("THREE.FBXLoader: unsupported Euler Order: Spherical XYZ. Animations and rotations may be incorrect.")}if("Lcl_Translation"in n&&t.position.fromArray(n.Lcl_Translation.value),"Lcl_Rotation"in n){var r=n.Lcl_Rotation.value.map(THREE.Math.degToRad);r.push("ZYX"),t.quaternion.setFromEuler((new THREE.Euler).fromArray(r))}if("Lcl_Scaling"in n&&t.scale.fromArray(n.Lcl_Scaling.value),"PreRotation"in n){var a=n.PreRotation.value.map(THREE.Math.degToRad);a[3]="ZYX";var i=(new THREE.Euler).fromArray(a);i=(new THREE.Quaternion).setFromEuler(i),t.quaternion.premultiply(i)}}function E(e){var t=[];return e.layer.forEach(function(e){t=t.concat(function(e){var t=[];if(void 0!==e.T&&Object.keys(e.T.curves).length>0){var n=b(e.modelName,e.T.curves,e.initialPosition,"position");void 0!==n&&t.push(n)}if(void 0!==e.R&&Object.keys(e.R.curves).length>0){var o=function(e,t,n,o){void 0!==t.x&&(y(t.x),t.x.values=t.x.values.map(THREE.Math.degToRad));void 0!==t.y&&(y(t.y),t.y.values=t.y.values.map(THREE.Math.degToRad));void 0!==t.z&&(y(t.z),t.z.values=t.z.values.map(THREE.Math.degToRad));var r=w(t),a=T(r,t,n);void 0!==o&&((o=o.map(THREE.Math.degToRad)).push("ZYX"),o=(new THREE.Euler).fromArray(o),o=(new THREE.Quaternion).setFromEuler(o));for(var i=new THREE.Quaternion,s=new THREE.Euler,c=[],u=0;u<a.length;u+=3)s.set(a[u],a[u+1],a[u+2],"ZYX"),i.setFromEuler(s),void 0!==o&&i.premultiply(o),i.toArray(c,u/3*4);return new THREE.QuaternionKeyframeTrack(e+".quaternion",r,c)}(e.modelName,e.R.curves,e.initialRotation,e.preRotations);void 0!==o&&t.push(o)}if(void 0!==e.S&&Object.keys(e.S.curves).length>0){var r=b(e.modelName,e.S.curves,e.initialScale,"scale");void 0!==r&&t.push(r)}return t}(e))}),new THREE.AnimationClip(e.name,-1,t)}function b(e,t,n,o){var r=w(t),a=T(r,t,n);return new THREE.VectorKeyframeTrack(e+"."+o,r,a)}function T(e,t,n){var o=n,r=[],a=-1,i=-1,s=-1;return e.forEach(function(e){if(t.x&&(a=t.x.times.indexOf(e)),t.y&&(i=t.y.times.indexOf(e)),t.z&&(s=t.z.times.indexOf(e)),-1!==a){var n=t.x.values[a];r.push(n),o[0]=n}else r.push(o[0]);if(-1!==i){var c=t.y.values[i];r.push(c),o[1]=c}else r.push(o[1]);if(-1!==s){var u=t.z.values[s];r.push(u),o[2]=u}else r.push(o[2])}),r}function w(e){var t=[];return void 0!==e.x&&(t=t.concat(e.x.times)),void 0!==e.y&&(t=t.concat(e.y.times)),void 0!==e.z&&(t=t.concat(e.z.times)),t=t.sort(function(e,t){return e-t}).filter(function(e,t,n){return n.indexOf(e)==t})}function y(e){for(var t=1;t<e.values.length;t++){var n=e.values[t-1],o=e.values[t]-n,r=Math.abs(o);if(r>=180){for(var a=r/180,i=o/a,s=n+i,c=e.times[t-1],u=(e.times[t]-c)/a,l=c+u,d=[],p=[];l<e.times[t];)d.push(l),l+=u,p.push(s),s+=i;e.times=I(e.times,t,d),e.values=I(e.values,t,p)}}}function R(){}function L(){}function x(e,t){this.dv=new DataView(e),this.offset=0,this.littleEndian=void 0===t||t}function k(){}function C(e){var t=e.match(/FBXVersion: (\d+)/);if(t)return parseInt(t[1]);throw new Error("THREE.FBXLoader: Cannot find the version number for the file given.")}function D(e){return e/46186158e3}function S(e){return e.split(",").map(function(e){return parseFloat(e)})}function H(e,t,n){return void 0===t&&(t=0),void 0===n&&(n=e.byteLength),THREE.LoaderUtils.decodeText(new Uint8Array(e,t,n))}function I(e,t,n){return e.slice(0,t).concat(n).concat(e.slice(t))}Object.assign(R.prototype,{getPrevNode:function(){return this.nodeStack[this.currentIndent-2]},getCurrentNode:function(){return this.nodeStack[this.currentIndent-1]},getCurrentProp:function(){return this.currentProp},pushStack:function(e){this.nodeStack.push(e),this.currentIndent+=1},popStack:function(){this.nodeStack.pop(),this.currentIndent-=1},setCurrentProp:function(e,t){this.currentProp=e,this.currentPropName=t},parse:function(e){this.currentIndent=0,this.allNodes=new k,this.nodeStack=[],this.currentProp=[],this.currentPropName="";var t=this,n=e.split("\n");return n.forEach(function(e,o){var r=e.match(/^[\s\t]*;/),a=e.match(/^[\s\t]*$/);if(!r&&!a){var i=e.match("^\\t{"+t.currentIndent+"}(\\w+):(.*){",""),s=e.match("^\\t{"+t.currentIndent+"}(\\w+):[\\s\\t\\r\\n](.*)"),c=e.match("^\\t{"+(t.currentIndent-1)+"}}");i?t.parseNodeBegin(e,i):s?t.parseNodeProperty(e,s,n[++o]):c?t.popStack():e.match(/^[^\s\t}]/)&&t.parseNodePropertyContinued(e)}}),this.allNodes},parseNodeBegin:function(e,t){var n=t[1].trim().replace(/^"/,"").replace(/"$/,""),o=t[2].split(",").map(function(e){return e.trim().replace(/^"/,"").replace(/"$/,"")}),r={name:n},a=this.parseNodeAttr(o),i=this.getCurrentNode();0===this.currentIndent?this.allNodes.add(n,r):n in i?("PoseNode"===n?i.PoseNode.push(r):void 0!==i[n].id&&(i[n]={},i[n][i[n].id]=i[n]),""!==a.id&&(i[n][a.id]=r)):"number"==typeof a.id?(i[n]={},i[n][a.id]=r):"Properties70"!==n&&(i[n]="PoseNode"===n?[r]:r),"number"==typeof a.id&&(r.id=a.id),""!==a.name&&(r.attrName=a.name),""!==a.type&&(r.attrType=a.type),this.pushStack(r)},parseNodeAttr:function(e){var t=e[0];""!==e[0]&&(t=parseInt(e[0]),isNaN(t)&&(t=e[0]));var n="",o="";return e.length>1&&(n=e[1].replace(/^(\w+)::/,""),o=e[2]),{id:t,name:n,type:o}},parseNodeProperty:function(e,t,n){var o=t[1].replace(/^"/,"").replace(/"$/,"").trim(),r=t[2].replace(/^"/,"").replace(/"$/,"").trim();"Content"===o&&","===r&&(r=n.replace(/"/g,"").replace(/,$/,"").trim());var a=this.getCurrentNode();if("Properties70"!==a.name){if("C"===o){var i=r.split(",").slice(1),s=parseInt(i[0]),c=parseInt(i[1]),u=r.split(",").slice(3);o="connections",function(e,t){for(var n=0,o=e.length,r=t.length;n<r;n++,o++)e[o]=t[n]}(r=[s,c],u=u.map(function(e){return e.trim().replace(/^"/,"")})),void 0===a[o]&&(a[o]=[])}"Node"===o&&(a.id=r),o in a&&Array.isArray(a[o])?a[o].push(r):"a"!==o?a[o]=r:a.a=r,this.setCurrentProp(a,o),"a"===o&&","!==r.slice(-1)&&(a.a=S(r))}else this.parseNodeSpecialProperty(e,o,r)},parseNodePropertyContinued:function(e){var t=this.getCurrentNode();t.a+=e,","!==e.slice(-1)&&(t.a=S(t.a))},parseNodeSpecialProperty:function(e,t,n){var o=n.split('",').map(function(e){return e.trim().replace(/^\"/,"").replace(/\s/,"_")}),r=o[0],a=o[1],i=o[2],s=o[3],c=o[4];switch(a){case"int":case"enum":case"bool":case"ULongLong":case"double":case"Number":case"FieldOfView":c=parseFloat(c);break;case"Color":case"ColorRGB":case"Vector3D":case"Lcl_Translation":case"Lcl_Rotation":case"Lcl_Scaling":c=S(c)}this.getPrevNode()[r]={type:a,type2:i,flag:s,value:c},this.setCurrentProp(this.getPrevNode(),r)}}),Object.assign(L.prototype,{parse:function(e){var t=new x(e);t.skip(23);var n=t.getUint32();console.log("THREE.FBXLoader: FBX binary version: "+n);for(var o=new k;!this.endOfContent(t);){var r=this.parseNode(t,n);null!==r&&o.add(r.name,r)}return o},endOfContent:function(e){return e.size()%16==0?(e.getOffset()+160+16&-16)>=e.size():e.getOffset()+160+16>=e.size()},parseNode:function(e,t){var n={},o=t>=7500?e.getUint64():e.getUint32(),r=t>=7500?e.getUint64():e.getUint32(),a=(t>=7500?e.getUint64():e.getUint32(),e.getUint8()),i=e.getString(a);if(0===o)return null;for(var s=[],c=0;c<r;c++)s.push(this.parseProperty(e));var u=s.length>0?s[0]:"",l=s.length>1?s[1]:"",d=s.length>2?s[2]:"";for(n.singleProperty=1===r&&e.getOffset()===o;o>e.getOffset();){var p=this.parseNode(e,t);null!==p&&this.parseSubNode(i,n,p)}return n.propertyList=s,"number"==typeof u&&(n.id=u),""!==l&&(n.attrName=l),""!==d&&(n.attrType=d),""!==i&&(n.name=i),n},parseSubNode:function(e,t,n){if(!0===n.singleProperty){var o=n.propertyList[0];Array.isArray(o)?(t[n.name]=n,n.a=o):t[n.name]=o}else if("Connections"===e&&"C"===n.name){var r=[];n.propertyList.forEach(function(e,t){0!==t&&r.push(e)}),void 0===t.connections&&(t.connections=[]),t.connections.push(r)}else if("Properties70"===n.name){Object.keys(n).forEach(function(e){t[e]=n[e]})}else if("Properties70"===e&&"P"===n.name){var a,i=n.propertyList[0],s=n.propertyList[1],c=n.propertyList[2],u=n.propertyList[3];0===i.indexOf("Lcl ")&&(i=i.replace("Lcl ","Lcl_")),0===s.indexOf("Lcl ")&&(s=s.replace("Lcl ","Lcl_")),a="Color"===s||"ColorRGB"===s||"Vector"===s||"Vector3D"===s||0===s.indexOf("Lcl_")?[n.propertyList[4],n.propertyList[5],n.propertyList[6]]:n.propertyList[4],t[i]={type:s,type2:c,flag:u,value:a}}else void 0===t[n.name]?"number"==typeof n.id?(t[n.name]={},t[n.name][n.id]=n):t[n.name]=n:"PoseNode"===n.name?(Array.isArray(t[n.name])||(t[n.name]=[t[n.name]]),t[n.name].push(n)):void 0===t[n.name][n.id]&&(t[n.name][n.id]=n)},parseProperty:function(e){var t=e.getString(1);switch(t){case"C":return e.getBoolean();case"D":return e.getFloat64();case"F":return e.getFloat32();case"I":return e.getInt32();case"L":return e.getInt64();case"R":var n=e.getUint32();return e.getArrayBuffer(n);case"S":n=e.getUint32();return e.getString(n);case"Y":return e.getInt16();case"b":case"c":case"d":case"f":case"i":case"l":var o=e.getUint32(),r=e.getUint32(),a=e.getUint32();if(0===r)switch(t){case"b":case"c":return e.getBooleanArray(o);case"d":return e.getFloat64Array(o);case"f":return e.getFloat32Array(o);case"i":return e.getInt32Array(o);case"l":return e.getInt64Array(o)}void 0===window.Zlib&&console.error("THREE.FBXLoader: External library Inflate.min.js required, obtain or import from https://github.com/imaya/zlib.js");var i=new x(new Zlib.Inflate(new Uint8Array(e.getArrayBuffer(a))).decompress().buffer);switch(t){case"b":case"c":return i.getBooleanArray(o);case"d":return i.getFloat64Array(o);case"f":return i.getFloat32Array(o);case"i":return i.getInt32Array(o);case"l":return i.getInt64Array(o)}default:throw new Error("THREE.FBXLoader: Unknown property type "+t)}}}),Object.assign(x.prototype,{getOffset:function(){return this.offset},size:function(){return this.dv.buffer.byteLength},skip:function(e){this.offset+=e},getBoolean:function(){return 1==(1&this.getUint8())},getBooleanArray:function(e){for(var t=[],n=0;n<e;n++)t.push(this.getBoolean());return t},getUint8:function(){var e=this.dv.getUint8(this.offset);return this.offset+=1,e},getInt16:function(){var e=this.dv.getInt16(this.offset,this.littleEndian);return this.offset+=2,e},getInt32:function(){var e=this.dv.getInt32(this.offset,this.littleEndian);return this.offset+=4,e},getInt32Array:function(e){for(var t=[],n=0;n<e;n++)t.push(this.getInt32());return t},getUint32:function(){var e=this.dv.getUint32(this.offset,this.littleEndian);return this.offset+=4,e},getInt64:function(){var e,t;return this.littleEndian?(e=this.getUint32(),t=this.getUint32()):(t=this.getUint32(),e=this.getUint32()),2147483648&t?(t=4294967295&~t,4294967295===(e=4294967295&~e)&&(t=t+1&4294967295),-(4294967296*t+(e=e+1&4294967295))):4294967296*t+e},getInt64Array:function(e){for(var t=[],n=0;n<e;n++)t.push(this.getInt64());return t},getUint64:function(){var e,t;return this.littleEndian?(e=this.getUint32(),t=this.getUint32()):(t=this.getUint32(),e=this.getUint32()),4294967296*t+e},getFloat32:function(){var e=this.dv.getFloat32(this.offset,this.littleEndian);return this.offset+=4,e},getFloat32Array:function(e){for(var t=[],n=0;n<e;n++)t.push(this.getFloat32());return t},getFloat64:function(){var e=this.dv.getFloat64(this.offset,this.littleEndian);return this.offset+=8,e},getFloat64Array:function(e){for(var t=[],n=0;n<e;n++)t.push(this.getFloat64());return t},getArrayBuffer:function(e){var t=this.dv.buffer.slice(this.offset,this.offset+e);return this.offset+=e,t},getString:function(e){for(var t=new Uint8Array(e),n=0;n<e;n++)t[n]=this.getUint8();var o=t.indexOf(0);return o>=0&&(t=t.slice(0,o)),THREE.LoaderUtils.decodeText(t)}}),Object.assign(k.prototype,{add:function(e,t){this[e]=t}})}()},function(e,t,n){"use strict";window.MYBIM={},MYBIM.Scene=n(10),MYBIM.Loader=n(11),MYBIM.Control=n(12),MYBIM.Clipping=n(13)},function(e,t,n){"use strict";var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}();var r=n(0),a=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e);var n=this;t&&t.container?n.container=t.container:(n.container=document.createElement("div"),document.body.appendChild(n.container)),n.container.style.cssText="width:100%; height:100%; position:absolute; left:0; top:0;",n.containerWidth=n.container.offsetWidth,n.containerHeight=n.container.offsetHeight,n.dop=new r,n.render=null,n.scene=null,n.camera=null,n.group=null,n.stats=null,n.clickCallback=null,n.initRender(),n.initScene(),n.initCamera(),n.initAnimation(),n.addClick(),window.addEventListener("resize",function(){n.containerWidth=n.container.offsetWidth,n.containerHeight=n.container.offsetHeight,n.camera.aspect=n.containerWidth/n.containerHeight,n.camera.updateProjectionMatrix(),n.render.setSize(n.containerWidth,n.containerHeight)})}return o(e,[{key:"initRender",value:function(){var e=new THREE.WebGLRenderer({antialias:!0});e.setSize(this.containerWidth,this.containerHeight),this.container.appendChild(e.domElement),this.render=e}},{key:"initScene",value:function(){this.scene=new THREE.Scene,this.group=new THREE.Group,this.scene.add(this.group)}},{key:"initCamera",value:function(){var e=new THREE.PerspectiveCamera(45,this.containerWidth/this.containerHeight,1,1e4);e.position.set(0,1,1),this.scene.add(e),this.camera=e}},{key:"initAnimation",value:function(){var e=this;!function t(){e.rendererCallBack(),e.draw(),e.stats&&e.stats.update(),requestAnimationFrame(t)}()}},{key:"rendererCallBack",value:function(){this.rendererControlCallBack&&this.rendererControlCallBack()}},{key:"addStats",value:function(){var e=this,t=document.createElement("script");document.head.appendChild(t),t.src="https://cdn.bootcss.com/stats.js/r16/Stats.min.js",t.onload=function(){e.stats=new Stats,document.body.appendChild(e.stats.domElement)}}},{key:"addLight",value:function(){var e=new THREE.DirectionalLight({color:16777215});this.scene.add(e),this.scene.add(new THREE.AmbientLight(4473924))}},{key:"draw",value:function(){this.render.render(this.scene,this.camera)}},{key:"setBgColor",value:function(e){this.render.setClearColor(e)}},{key:"addHelper",value:function(){var e=new THREE.AxesHelper(50);this.scene.add(e)}},{key:"addPanorama",value:function(e){this.scene.background&&this.scene.background.dispose(),this.scene.background=(new THREE.CubeTextureLoader).load(e)}},{key:"addClick",value:function(){var e=this,t=new THREE.Raycaster,n=new THREE.Vector2,o=e.container,r=e.dop,a=e.camera;e.dop.$(e.container).on("tap",function(i){if("function"==typeof e.clickCallback){var s=o.getBoundingClientRect().left,c=o.getBoundingClientRect().top,u="pc"===r.browserRedirect()?i.clientX-s:i.touches[0].clientX-s,l="pc"===r.browserRedirect()?i.clientY-c:i.touches[0].clientY-c;n.x=u/o.offsetWidth*2-1,n.y=-l/o.offsetHeight*2+1,t.setFromCamera(n,a);var d=t.intersectObjects(e.scene.children,!0);d.length>=1&&e.clickCallback(d)}})}},{key:"setColorById",value:function(e,t){var n=this.group.getObjectById(e).material.clone();n.color.set(t),this.group.getObjectById(e).material=n}},{key:"setShowById",value:function(e,t){this.group.getObjectById(e).visible=t}}]),e}();e.exports=a},function(e,t,n){"use strict";var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}();var r=new(n(0)),a=function(){function e(t){if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),!(t.scene instanceof MYBIM.Scene))throw new Error("当前场景设置错误");this.SCENE=t.scene,this.material=new THREE.MeshLambertMaterial({color:65535,side:THREE.DoubleSide}),this.modelNormalHeight=200,this.model_id=null}return o(e,[{key:"loadFBX",value:function(e,t){var n=this;(new THREE.FBXLoader).load(e,function(e){t(e),n.SCENE.group.add(e),n.SCENE.draw()},function(e){console.log(e.loaded/e.total*100+"% loaded")},function(e){console.error("加载数据发生错误")})}},{key:"fbxExporter",value:function(e,t,n){(new THREE.FBXLoader).load(e,function(e){var o=JSON.stringify(e.toJSON()),r=document.createElement("a");r.download=t+".json",r.href="data:text/json;charset=utf-8,"+encodeURIComponent(o),document.body.appendChild(r),r.click(),n(e)},function(e){console.log(e.loaded/e.total*100+"% loaded")},function(e){console.error("加载数据发生错误")})}},{key:"loadJSON",value:function(e,t){var n=new THREE.ObjectLoader;console.log(JSON.parse(e));var o=n.parse(JSON.parse(e));t(o),this.SCENE.group.add(o);var r=new THREE.Box3;r.expandByObject(o),this.SCENE.group.position.set(-((r.max.x-r.min.x)/2+r.min.x),-((r.max.y-r.min.y)/2+r.min.y),-((r.max.z-r.min.z)/2+r.min.z)),this.SCENE.draw()}},{key:"loadComponent",value:function(e){for(var t=new THREE.Geometry,n=0;n<e.metadata.vertices_count;n++)t.vertices.push(new THREE.Vector3(e.vertices[3*n],e.vertices[3*n+1],e.vertices[3*n+2]));for(var o=0;o<e.metadata.faces_count;o++)t.faces.push(new THREE.Face3(e.faces[4*o+1],e.faces[4*o+2],e.faces[4*o+3]));t.computeFaceNormals();var r=new THREE.Mesh(t,this.material);this.SCENE.group.add(r)}},{key:"loadModelList",value:function(e){var t=this;t.deleteModel(),r.get("http://139.196.104.14:21059/bim/v1/version?model_id="+e,function(n){var o=JSON.parse(n);t.model_id=e;for(var a=0,i="",s=0;s<1e3;s++)i+=","+o.data[s].compont_id,a=s+1;!function n(i){r.post("http://139.196.104.14:21059/bim/v1",{component_id:i},function(r){if(e===t.model_id){for(var i=JSON.parse(r),s=0;s<i.data.length;s++)loader.loadComponent(i.data[s]);if(t.modelScale(),t.modelCenter(),console.log(a,o.data.length),a!==o.data.length-1){var c=a+1e3;c>=o.data.length-1&&(c=o.data.length-1);for(var u="",l=a;l<c;l++)u+=","+o.data[l].compont_id,a=l+1;n(u)}}})}(i)})}},{key:"modelCenter",value:function(){var e=new THREE.Box3;e.expandByObject(this.SCENE.group),this.SCENE.group.position.set(-((e.max.x-e.min.x)/2+e.min.x),-((e.max.y-e.min.y)/2+e.min.y),-((e.max.z-e.min.z)/2+e.min.z))}},{key:"modelScale",value:function(){var e=new THREE.Box3;e.expandByObject(this.SCENE.group);var t=this.modelNormalHeight/((e.max.y-e.min.y)/this.SCENE.group.scale.x);t=t.toFixed(4),this.SCENE.group.scale.set(t,t,t)}},{key:"deleteModel",value:function(){this.SCENE.group.traverse(function(e){e instanceof THREE.Mesh&&e.geometry.dispose()}),this.SCENE.group=new THREE.Group}}]),e}();e.exports=a},function(e,t,n){"use strict";var o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}();var a=function(){function e(t){if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),!(t.scene instanceof MYBIM.Scene))throw new Error("当前场景设置错误");var n=this;n.SCENE=t.scene,n.group=null,n.position="object"===o(t.position)?t.position:{x:0,y:0,z:100},n.control=null,n.SCENE.rendererControlCallBack=function(){n.control&&n.control.update()}}return r(e,[{key:"initModelControl",value:function(){var e=this;e.SCENE.camera.position.set(e.position.x,e.position.y,e.position.z),e.group=new THREE.Group,e.group.add(e.SCENE.camera),e.SCENE.scene.add(e.group);var t=new THREE.OrbitControls(e.SCENE.camera,e.SCENE.render.domElement);e.control=t,t.enableDamping=!0,t.enableZoom=!0,t.autoRotate=!1,t.autoRotateSpeed=.5,t.enablePan=!0,t.keyPanSpeed=10,t.panSpeed=.3,t.mouseButtons={PAN:null,ZOOM:THREE.MOUSE.MIDDLE,ORBIT:THREE.MOUSE.RIGHT},t.keys={LEFT:68,UP:83,RIGHT:65,BOTTOM:87},document.addEventListener("keydown",function(n){e.control.enabled&&(81===n.keyCode&&(e.group.position.y-=t.keyPanSpeed),69===n.keyCode&&(e.group.position.y+=t.keyPanSpeed),16===n.keyCode&&(t.keyPanSpeed=1))}),document.addEventListener("keyup",function(n){e.control.enabled&&16===n.keyCode&&(t.keyPanSpeed=10)})}},{key:"initPanoControl",value:function(){this.SCENE.camera.position.set(this.position.x,this.position.y,this.position.z),this.SCENE.camera.fov=75,this.SCENE.camera.updateProjectionMatrix(),this.control=new THREE.OrbitControls(this.SCENE.camera,this.SCENE.render.domElement),this.control.autoRotate=!0,this.control.autoRotateSpeed=.5}},{key:"setControlEnabled",value:function(e){this.control.enabled=e}}]),e}();e.exports=a},function(e,t,n){"use strict";var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}();var r=function(){function e(t){if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),!(t.scene instanceof MYBIM.Scene))throw new Error("当前场景设置错误");this.SCENE=t.scene,this.horizontalKeyFun=null,this.verticalKeyFun=null,this.verticalOffset=new THREE.Vector3,this.speed=10,this.addSpeedControl()}return o(e,[{key:"addSpeedControl",value:function(){var e=this;document.addEventListener("keydown",function(t){16===t.keyCode&&(e.speed=1)}),document.addEventListener("keyup",function(t){16===t.keyCode&&(e.speed=10)})}},{key:"horizontalClipping",value:function(){var e=this,t=e.SCENE.render;e.disposeClipping();var n=new THREE.Plane(new THREE.Vector3(0,-1,0),0);t.clippingPlanes=[n],t.localClippingEnabled=!0,e.horizontalKeyFun=function(t){38===t.keyCode&&(n.constant+=e.speed),40===t.keyCode&&(n.constant-=e.speed)},document.addEventListener("keydown",e.horizontalKeyFun)}},{key:"verticalClipping",value:function(){var e=this,t=e.SCENE.render,n=new THREE.Matrix4;e.disposeClipping();var o=new THREE.Plane(new THREE.Vector3(1,0,0),0);function r(t){return t.applyEuler(e.SCENE.camera.rotation),t.y=0,t.normalize(),t.multiplyScalar(e.speed),t}function a(){o.translate(new THREE.Vector3(-e.verticalOffset.x,0,-e.verticalOffset.z))}function i(){o.translate(e.verticalOffset)}t.clippingPlanes=[o],t.localClippingEnabled=!0,e.verticalKeyFun=function(t){if(38===t.keyCode){a();var s=new THREE.Vector3;s.z-=e.speed,e.verticalOffset.add(r(s)),i()}if(40===t.keyCode){a();var c=new THREE.Vector3;c.z+=e.speed,e.verticalOffset.add(r(c)),i()}if(37===t.keyCode){a();var u=new THREE.Vector3;u.x-=e.speed,e.verticalOffset.add(r(u)),i()}if(39===t.keyCode){a();var l=new THREE.Vector3;l.x+=e.speed,e.verticalOffset.add(r(l)),i()}67===t.keyCode&&(a(),n.makeRotationY(e.speed/180*Math.PI),o.normal.applyMatrix4(n),i()),86===t.keyCode&&(a(),n.makeRotationY(-e.speed/180*Math.PI),o.normal.applyMatrix4(n),i())},document.addEventListener("keydown",e.verticalKeyFun)}},{key:"disposeClipping",value:function(){var e=this.SCENE.render;document.removeEventListener("keydown",this.horizontalKeyFun),document.removeEventListener("keydown",this.verticalKeyFun),e.clippingPlanes=[],e.localClippingEnabled=!1}}]),e}();e.exports=r}]);